---
title: Пустые переменные — руководство по языку C#
description: В этой статье приведены сведения о поддержке в C# пустых переменных (переменных, которым не присваиваются значения) и описаны способы их использования.
ms.technology: csharp-fundamentals
ms.date: 09/22/2020
ms.openlocfilehash: 7562da880ff3136dfc04ce4061bafa8ed55f5a23
ms.sourcegitcommit: 38999dc0ec4f7c4404de5ce0951b64c55997d9ab
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/02/2021
ms.locfileid: "99426922"
---
# <a name="discards---c-guide"></a>Пустые переменные — руководство по языку C#

Начиная с версии 7.0 язык C# поддерживает пустые переменные. Это переменные-заполнители, которые намеренно не используются в коде приложения. Пустые переменные эквивалентны переменным, которым не присвоены значения; пустые переменные не имеют значений. Пустые переменные объявляют свое намерение компилятору и другим разработчикам, которые читают ваш код. Вы намерены игнорировать результат выражения. Может потребоваться игнорировать результат выражения, один или несколько элементов кортежного выражения, параметр `out` метода или целевой объект выражения сопоставления шаблонов.

Так как пустая переменная по сути всего одна, этой переменной может даже не выделяться память. Пустые переменные помогают расходовать память более экономно. Пустые переменные делают намерение кода более явным. Они улучшают его удобочитаемость и обслуживаемость.

Чтобы использовать пустую переменную, назначьте ей в качестве имени символ подчеркивания (`_`). Например, следующий вызов метода возвращает кортеж, где первое и второе значения представляют собой пустые переменные. `area` — это ранее объявленная переменная, установленная для третьего компонента, возвращаемого `GetCityInformation`:

```csharp
(_, _, area) = city.GetCityInformation(cityName);
```

Начиная с C# 9.0, можно использовать пустые переменные для указания неиспользуемых входных параметров лямбда-выражения. Дополнительные сведения см. в разделе [Входные параметры лямбда-выражения](language-reference/operators/lambda-expressions.md#input-parameters-of-a-lambda-expression) статьи о [лямбда-выражениях](language-reference/operators/lambda-expressions.md).

Если `_` является допустимой пустой переменной, при попытке получить ее значение или использовать ее в операции присваивания компилятор выдаст ошибку CS0301: "The name '\_' doesn't exist in the current context" (Имя "_" не существует в текущем контексте). Это вызвано тем, что переменной `_` не присвоено значение и, возможно, даже не выделена память. Если бы это была настоящая переменная, вам бы не удалось отменить более одного значения, как в предыдущем примере.

## <a name="tuple-and-object-deconstruction"></a>Деконструкция кортежей и объектов

Пустые переменные удобны при работе с кортежами, когда в коде вашего приложения используются одни элементы кортежа и игнорируются другие. Например, следующий метод `QueryCityDataForYears` возвращает кортеж со следующими данными: название города, его площадь, год, численность населения города в этом году, другой год и численность населения города в том году. В примере показано изменение численности населения за эти два года. Из доступных в кортеже данных нас не интересует площадь города, а название города и две даты известны нам уже на этапе разработки. Следовательно, нас интересуют только два значения численности населения, которые хранятся в кортеже. Остальные значения можно обработать как пустые переменные.  

:::code language="csharp" source="snippets/discards/discard-tuple.cs" ID="DiscardTupleMember" :::

Подробнее о деконструкции кортежей с помощью пустых переменных: [Деконструкция кортежей и других типов](deconstruct.md#deconstructing-tuple-elements-with-discards).

Метод `Deconstruct` класса, структуры или интерфейса также позволяет извлекать и деконструировать определенный набор данных из объекта. Пустые переменные можно использовать, когда вы хотите работать только с набором деконструируемых значений. В следующем примере показана деконструкция объекта `Person` на четыре строки (имя, фамилия, город и область), но для фамилии и области используются пустые переменные.

:::code language="csharp" source="snippets/discards/discard-class.cs" :::

Подробнее о деконструкции пользовательских типов с помощью пустых переменных: [Деконструкция кортежей и других типов](deconstruct.md#deconstructing-a-user-defined-type-with-discards).

## <a name="pattern-matching-with-switch"></a>Сопоставление шаблонов с помощью switch

*Шаблон пустой переменной* можно использовать при сопоставлении шаблонов с ключевым словом [switch](language-reference/keywords/switch.md). Каждое выражение всегда соответствует шаблону пустой переменной. (Его можно использовать с выражениями [is](language-reference/keywords/is.md). Но это случается редко, так как пустую переменную можно удалить без изменения ее значения.)

В следующем примере определяется метод `ProvidesFormatInfo`, который использует операторы [is](language-reference/keywords/is.md), чтобы узнать, предоставляет ли объект реализацию <xref:System.IFormatProvider> и не является ли он `null`. В примере также используется шаблон пустой переменной для обработки объектов любого другого типа с определенным значением.

:::code language="csharp" source="snippets/discards/discard-pattern2.cs" ID="DiscardSwitchExample" :::

## <a name="calls-to-methods-with-out-parameters"></a>Вызовы методов с параметрами `out`

При вызове метода `Deconstruct` для деконструкции пользовательского типа (экземпляра класса, структуры или интерфейса) вы можете сделать пустыми значения отдельных аргументов `out`. Но при вызове метода с параметром `out` вы также можете сделать пустыми значения аргументов `out`.

В следующем примере вызывается метод [DateTime.TryParse(String, out DateTime)](<xref:System.DateTime.TryParse(System.String,System.DateTime@)>), который определяет, является ли строковое представление даты допустимым для текущего языка и региональных параметров. Так как этот пример связан только с проверкой строки даты и не включает анализ этой строки для получения самой даты, аргумент `out` метода является пустым.

:::code language="csharp" source="snippets/discards/discard-out1.cs" ID="DiscardOutParameter" :::

## <a name="a-standalone-discard"></a>Отдельная пустая переменная

Вы можете использовать отдельную пустую переменную, чтобы указать, что переменную необходимо игнорировать. Одним из типичных вариантов использования является присваивание, гарантирующее, что аргумент не имеет значение NULL. В следующем коде для принудительного назначения используется пустая переменная. В правой части назначения используется [оператор объединения со значением NULL](language-reference/operators/null-coalescing-operator.md) для вызова <xref:System.ArgumentNullException?displayProperty=nameWithType>, когда аргумент имеет значение `null`. Коду не требуется результат присваивания, поэтому используется пустая переменная. Выражение вызывает проверку значения NULL. Пустая переменная уточняет намерение: результат назначения не требуется или используется.

:::code language="csharp" source="snippets/discards/standalone-discard1.cs" ID="ArgNullCheck" :::

В следующем примере отдельная пустая переменная используется, чтобы игнорировать объект <xref:System.Threading.Tasks.Task>, возвращаемый асинхронной операцией. Назначение задачи приводит к подавлению исключения, созданного операцией перед завершением. Это делает ваше намерение явным: Вам нужно назначить `Task` пустой переменной и пропустить все ошибки, созданные в этой асинхронной операции.

:::code language="csharp" source="snippets/discards/standalone-discard1.cs" ID="SnippetDiscardTask" :::

Если задача не назначена пустой переменной, следующий код создает предупреждение компилятора:

:::code language="csharp" source="snippets/discards/standalone-discard1.cs" ID="SnippetNoDiscardTask" :::

> [!NOTE]
> При запуске любого из предыдущих двух примеров с помощью отладчика программа будет остановлена при возникновении исключения. Если отладчик не присоединен, в обоих случаях исключение пропускается без предупреждения.

`_` также является допустимым идентификатором. При использовании вне поддерживаемого контекста `_` считается не пустой, а действительной переменной. Если в области уже есть идентификатор с именем `_`, использование `_` в качестве отдельной пустой переменной может привести к следующим результатам:

- Случайное изменение значения переменной `_` в области из-за присвоения ей значения пустой переменной. Пример:
   :::code language="csharp" source="snippets/discards/standalone-discard2.cs" ID="VariableIdentifier" :::
- Ошибка компилятора из-за нарушения безопасности типов. Пример:
   :::code language="csharp" source="snippets/discards/standalone-discard2.cs" ID="VariableTypeInference" :::
- Ошибка компилятора CS0136 "Невозможно объявить локальную переменную или параметр с именем \_ в этой области, так как это имя используется для определения локальной переменной или параметра во включающей локальной области". Пример:
   :::code language="csharp" source="snippets/discards/standalone-discard2.cs" ID="CannotRedeclare" :::

## <a name="see-also"></a>См. также раздел

- [Деконструкция кортежей и других типов](deconstruct.md)
- [Ключевое слово `is`](language-reference/keywords/is.md)
- [Ключевое слово `switch`](language-reference/keywords/switch.md)
