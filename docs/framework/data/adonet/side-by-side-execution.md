---
title: Параллельное выполнение
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: 609fc7b7cefd92e38ecfff54e5ac1651e855e4b7
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2020
ms.locfileid: "91188942"
---
# <a name="side-by-side-execution-in-adonet"></a>Одновременное выполнение в ADO.NET

Параллельное выполнение в .NET Framework — это возможность выполнения приложения на компьютере, на котором установлено несколько версий .NET Framework, исключительно с использованием версии, для которой было скомпилировано приложение. Подробные сведения о настройке параллельного выполнения см. в разделе [параллельное выполнение](../../deployment/side-by-side-execution.md).  
  
 Приложение, скомпилированное с помощью одной версии .NET Framework, может выполняться в другой версии .NET Framework. Однако рекомендуется компилировать версию приложения для каждой установленной версии .NET Framework и запускать их отдельно. В любом сценарии следует помнить об изменениях в ADO.NET между выпусками, которые могут повлиять на прямую или обратную совместимость приложения.  
  
## <a name="forward-compatibility-and-backward-compatibility"></a>Прямая и обратная совместимость  

 Прямая совместимость означает, что приложение можно скомпилировать в более ранней версии .NET Framework, но по-прежнему будет успешно выполняться в более поздней версии .NET Framework. Код ADO.NET, написанный для .NET Framework версии 1,1, является прямой совместимость с более поздними версиями.  
  
 Обратная совместимость означает, что приложение компилируется для более новой версии .NET Framework, но продолжит работать в более ранних версиях .NET Framework без потери функциональности. Конечно, это не будет так для функций, появившихся в новой версии .NET Framework.  
  
## <a name="the-net-framework-data-provider-for-odbc"></a>Поставщик данных .NET Framework для ODBC  

 Начиная с версии 1,1, поставщик данных .NET Framework для ODBC ( <xref:System.Data.Odbc> ) включается в состав .NET Framework.
  
 Если у вас есть приложение, разработанное для .NET Framework версии 1,0, которая использует поставщик данных ODBC для подключения к источнику данных и вы хотите запустить это приложение на .NET Framework версии 1,1 или более поздней, необходимо обновить пространство имен для поставщика данных ODBC на **System. Data. ODBC**. Затем необходимо перекомпилировать его для более новой версии .NET Framework.  
  
 Если у вас есть приложение, разработанное для .NET Framework версии 2,0 или более поздней, которое использует поставщик данных ODBC для подключения к источнику данных и вы хотите запустить это приложение на .NET Framework версии 1,0, необходимо скачать поставщик данных ODBC и установить его в системе .NET Framework версии 1,0. Затем необходимо изменить пространство имен для поставщика данных ODBC на **Microsoft. Data. ODBC**и повторно скомпилировать приложение для .NET Framework версии 1,0.  
  
## <a name="the-net-framework-data-provider-for-oracle"></a>Поставщик данных .NET Framework для Oracle  

 Начиная с версии 1,1, поставщик данных .NET Framework для Oracle ( <xref:System.Data.OracleClient> ) включается в состав .NET Framework.
  
 Если у вас есть приложение, разработанное для .NET Framework версии 2,0 или более поздней, которое использует поставщик данных для подключения к источнику данных и вы хотите запустить это приложение на .NET Framework версии 1,0, необходимо скачать поставщик данных и установить его в системе .NET Framework версии 1,0.  
  
## <a name="code-access-security"></a>Управление доступом для кода  

 Поставщики данных .NET Framework в .NET Framework версии 1,0 ( <xref:System.Data.SqlClient> ,) должны <xref:System.Data.OleDb> выполняться с разрешением FullTrust. Любая попытка использовать поставщики данных .NET Framework k из .NET Framework версии 1,0 в зоне с разрешением меньше, чем FullTrust, приводит к возникновению исключения <xref:System.Security.SecurityException> .  
  
 Однако начиная с версии .NET Framework 2,0, все поставщики данных .NET Framework могут использоваться в зонах с частичным доверием. Кроме того, в .NET Framework поставщиков данных в .NET Framework версии 1,1 добавлена новая функция безопасности. Эта возможность позволяет указывать, какие строки соединения могут использоваться в конкретной зоне безопасности. Также можно отключить использование пустых паролей для конкретной зоны безопасности. Для получения дополнительной информации см. [Code Access Security and ADO.NET](code-access-security.md).  
  
 Поскольку каждая установка .NET Framework имеет отдельный файл Security.config, проблемы совместимости с параметрами безопасности отсутствуют. Однако если приложение зависит от дополнительных возможностей безопасности ADO.NET, включенных в .NET Framework версии 1,1 и более поздних, вы не сможете распространить ее на систему версии 1,0.  
  
## <a name="sqlcommand-execution"></a>Выполнение SqlCommand  

 Начиная с версии .NET Framework 1,1, способ <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> выполнения команд в источнике данных был изменен.  
  
 В .NET Framework версии 1,0 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> выполнялись все команды в контексте хранимой процедуры **sp_executesql** . В результате этого команды, которые влияли на состояние соединения (например, SET NOCOUNT ON), применялись только к выполнению текущей команды. Состояние соединения не изменялось для любых последующих команд, выполнявшихся при открытом соединении.  
  
 В .NET Framework версии 1,1 и более поздних версиях <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> выполняет команду только в контексте хранимой процедуры **sp_executesql** , если команда содержит параметры, что дает выигрыш в производительности. В результате этого, если команда, влияющая на состояние соединения, включена в непараметризованную команду, она изменяет состояние соединения для всех последующих команд, выполняемых при открытом соединении.  
  
 Рассмотрим следующий пакет команд, выполняемых при обращении к <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 В .NET Framework версии 1,1 и более поздних параметр NOCOUNT будет иметь значение ON для всех последующих команд, выполняемых в то время, когда соединение открыто. В .NET Framework версии 1,0 параметр NOCOUNT имеет значение ON только для текущего выполнения команды.  
  
 Это изменение может повлиять как на прямую, так и на обратную совместимость приложения, если вы зависели от поведения в <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> любой из версий .NET Framework.  
  
 Для приложений, которые работают в более ранних и более поздних версиях .NET Framework, можно написать код, чтобы убедиться в том, что поведение не отличается от версии, на которой выполняется. Если требуется сделать так, чтобы команда изменяла состояние соединения для всех последующих команд, рекомендуется выполнять команду с помощью <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>. Если требуется сделать так, чтобы команда не изменяла соединение для всех последующих команд, рекомендуется включать в нее команды для сброса состояния соединения. Пример:  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a>См. также раздел

- [Общие сведения об ADO.NET](ado-net-overview.md)
- [Извлечение и изменение данных в ADO.NET](retrieving-and-modifying-data.md)
