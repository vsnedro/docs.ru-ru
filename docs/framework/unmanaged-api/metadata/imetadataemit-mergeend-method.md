---
title: Метод IMetaDataEmit::MergeEnd
ms.date: 03/30/2017
api_name:
- IMetaDataEmit.MergeEnd
api_location:
- mscoree.dll
api_type:
- COM
f1_keywords:
- IMetaDataEmit::MergeEnd
helpviewer_keywords:
- MergeEnd method [.NET Framework metadata]
- IMetaDataEmit::MergeEnd method [.NET Framework metadata]
ms.assetid: 2d64315a-1af1-4c60-aedf-f8a781914aea
topic_type:
- apiref
ms.openlocfilehash: feb81b86190f953b50f43f244f4e58a0a482f86e
ms.sourcegitcommit: 03fec33630b46e78d5e81e91b40518f32c4bd7b5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2020
ms.locfileid: "84003923"
---
# <a name="imetadataemitmergeend-method"></a>Метод IMetaDataEmit::MergeEnd

Выполняет слияние в текущую область всех областей метаданных, указанных одним или несколькими ранними вызовами метода [IMetaDataEmit:: Merge](imetadataemit-merge-method.md).

## <a name="syntax"></a>Синтаксис

```cppcpp
HRESULT MergeEnd ();
```

## <a name="parameters"></a>Параметры

Этот метод не принимает параметров.

## <a name="remarks"></a>Примечания

Эта подпрограммы запускает фактическое слияние метаданных всех областей импорта, заданных предыдущими вызовами `IMetaDataEmit::Merge` , в текущую область вывода.

К объединению применяются следующие особые условия.

- Идентификатор версии модуля (MVID) никогда не импортируется, так как он уникален для метаданных в области импорта.

- Существующие свойства модуля не перезаписываются.

  Если свойства модуля уже заданы для текущей области, свойства модуля не импортируются. Однако если свойства модуля не были заданы в текущей области, они импортируются только один раз при первом обнаружении. Если эти свойства модуля встречаются снова, они являются повторяющимися. Если сравниваются значения всех свойств модуля (кроме MVID) и не найдены дубликаты, возникает ошибка.

- Для определений типов ( `TypeDef` ) в текущую область не объединяются дубликаты. `TypeDef`объекты проверяются на наличие дубликатов по каждому *полному*  +  *GUID*  +  *номеру версии*идентификатора GUID имени объекта. Если существует совпадение с именем или идентификатором GUID, а любой из двух других элементов отличается, возникает ошибка. В противном случае, если все три элемента совпадают, `MergeEnd` выполняет проверку курсора, чтобы убедиться, что записи действительно являются дубликатами. Если нет, возникает ошибка. Эта проверка курсора ищет:

  - Одни и те же объявления членов, происходящие в том же порядке. Элементы, помеченные как `mdPrivateScope` (см. Перечисление [кормесодаттр](cormethodattr-enumeration.md) ), не включены в эту проверку; они объединяются специально.

  - Тот же макет класса.

  Это означает, что `TypeDef` объект всегда должен быть полностью и согласованным в каждой области метаданных, в которой он объявлен. Если его реализации (для класса) распределяются по нескольким единицам компиляции, предполагается, что полное определение находится в каждой области и не помещается в каждую область. Например, если имена параметров имеют отношение к контракту, они должны выдаваться одинаковым образом в каждую область видимости. Если они не важны, они не должны выдаваться в метаданные.

  Исключением является то, что `TypeDef` объект может иметь инкрементные элементы, помеченные как `mdPrivateScope` . При возникновении этих операций `MergeEnd` они постепенно добавляются в текущую область без учета дубликатов. Поскольку компилятор понимает частную область, компилятор должен отвечать за применение правил.

- Относительные виртуальные адреса (RVA) не импортируются и не объединяются; Предполагается, что компилятор повторно выдает эти сведения.

- Пользовательские атрибуты объединяются только при слиянии элемента, к которому они присоединены. Например, пользовательские атрибуты, связанные с классом, объединяются при первом обнаружении класса. Если настраиваемые атрибуты связаны с элементом `TypeDef` или `MemberDef` , относящимся к единице компиляции (например, к отметке времени для компиляции элемента), они не объединяются и компилятор удаляет или обновляет такие метаданные.

## <a name="requirements"></a>Требования

**Платформы:** см. раздел [Требования к системе](../../get-started/system-requirements.md).

**Заголовок:** COR. h

**Библиотека:** Используется в качестве ресурса в MSCorEE. dll

**.NET Framework версии:**[!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]

## <a name="see-also"></a>См. также статью

- [Интерфейс IMetaDataEmit](imetadataemit-interface.md)
- [Интерфейс IMetaDataEmit2](imetadataemit2-interface.md)
