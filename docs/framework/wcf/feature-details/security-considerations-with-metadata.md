---
title: Вопросы безопасности при использовании метаданных
ms.date: 03/30/2017
ms.assetid: e78ef8ab-4f63-4656-ab93-b1deab2666d5
ms.openlocfilehash: c41ebf5c39e74932a4bade610c4e236b28444327
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84601027"
---
# <a name="security-considerations-with-metadata"></a>Вопросы безопасности при использовании метаданных
При использовании функций метаданных в Windows Communication Foundation (WCF) учитывайте влияние на безопасность публикации, извлечения и использования метаданных службы.  
  
## <a name="when-to-publish-metadata"></a>В каких случаях следует публиковать метаданные  
 Службы WCF по умолчанию не публикуют метаданные. Чтобы опубликовать метаданные для службы WCF, необходимо явно включить публикацию метаданных, добавив конечные точки метаданных в службу (см. раздел [Публикация метаданных](publishing-metadata.md)). Если публикацию метаданных оставить отключенной, это уменьшит возможности для атаки на службу и снизит риск непреднамеренного раскрытия информации. Не все службы должны публиковать метаданные. Если публиковать метаданные не требуется, подумайте о том, чтобы отключить их. Обратите внимание, что вы по-прежнему можете создавать метаданные и клиентский код непосредственно из сборок службы с помощью [средства служебной программы метаданных ServiceModel (Svcutil. exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md). Дополнительные сведения об использовании программы Svcutil. exe для экспорта метаданных см. в разделе [как использовать Svcutil. exe для экспорта метаданных из скомпилированного кода службы](how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md).  
  
## <a name="publishing-metadata-using-a-secure-binding"></a>Публикация метаданных с помощью безопасной привязки  
 Привязки к метаданным по умолчанию, предоставляемые WCF, не являются безопасными и разрешают анонимный доступ к метаданным. Метаданные службы, публикуемые службой WCF, содержат подробное описание службы и могут преднамеренно или непреднамеренно содержать конфиденциальную информацию. Например, метаданные службы могут содержать сведения об операциях инфраструктуры, которые не должны распространяться публично. Чтобы защитить метаданные службы от несанкционированного доступа, можно воспользоваться безопасной привязкой конечной точки метаданных. Конечные точки метаданных отвечают на HTTP-запросы GET, которые могут использовать для защиты метаданных протокол SSL. Дополнительные сведения см. [в разделе как защитить конечные точки метаданных](how-to-secure-metadata-endpoints.md).  
  
 Кроме того, защита конечных точек метаданных позволяет запрашивающей стороне безопасным образом получать метаданные службы, не опасаясь, что они будут искажены или подделаны.  
  
## <a name="using-only-trusted-metadata"></a>Использование только надежных метаданных  
 С помощью метаданных службы можно автоматически создавать компоненты среды выполнения, необходимые для вызова службы. Кроме того, метаданные можно использовать на этапе проектирования, чтобы разрабатывать клиентские приложения, или во время выполнения, чтобы динамически обновлять привязку, с помощью которой клиент вызывает службу.  
  
 При получении метаданных без соответствующей защиты они могут быть искажены или подделаны. Искаженные метаданные могут перенаправить клиент на вредоносную службу, они могут содержать неверные параметры безопасности или опасные структуры XML. Документы с метаданным могут быть большими, и их часто сохраняют в файловой системе. Чтобы защититься от искажения или подделки метаданных, следует использовать для запроса метаданных службы безопасную привязку, если она доступна.  
  
## <a name="using-safe-techniques-for-processing-metadata"></a>Использование безопасных методов обработки метаданных  
 Метаданные службы часто запрашиваются у службы по сети с использованием стандартных протоколов, например WS-MetadataExchange (MEX). Многие форматы метаданных включают механизмы, позволяющие ссылаться на дополнительные метаданные. Тип <xref:System.ServiceModel.Description.MetadataExchangeClient> автоматически обрабатывает ссылки в документах WSDL, схемах XML и документах MEX. Размер объекта <xref:System.ServiceModel.Description.MetadataSet>, созданного на базе полученных метаданных, прямо пропорционален значению <xref:System.ServiceModel.Description.MetadataExchangeClient.MaximumResolvedReferences%2A> используемого экземпляра <xref:System.ServiceModel.Description.MetadataExchangeClient> и значению `MaxReceivedMessageSize` привязки, используемой данным экземпляром <xref:System.ServiceModel.Description.MetadataExchangeClient>. Устанавливайте эти квоты в соответствии с потребностями конкретной задачи.  
  
 В WCF метаданные службы обрабатываются как XML. При обработке документов XML приложения должны защищать себя от опасных структур XML. Используйте <xref:System.Xml.XmlDictionaryReader> с соответствующими квотами при обработке XML, а также задайте <xref:System.Xml.XmlTextReader.DtdProcessing%2A> для свойства значение <xref:System.Xml.DtdProcessing.Prohibit> .  
  
 Система метаданных в WCF является расширяемой. расширения метаданных можно зарегистрировать в файле конфигурации приложения (см. раздел [расширение системы метаданных](../extending/extending-the-metadata-system.md)). Расширения метаданных могут выполнять произвольный код, поэтому файлы конфигурации приложений необходимо защищать с помощью соответствующих списков управления доступом и регистрировать только надежные реализации расширений метаданных.  
  
## <a name="validating-generated-clients"></a>Проверка созданных клиентов  
 При создании клиентского кода из метаданных, полученных из ненадежного источника, проверьте созданный код клиента на соответствие принятым политикам безопасности клиентских приложений. Можно воспользоваться поведением проверки, чтобы проконтролировать параметры клиентской привязки, или визуально проверить код, созданный автоматически. Пример реализации клиента, который проверяет поведение, см. в разделе [проверка клиентов](../samples/client-validation.md).  
  
## <a name="protecting-application-configuration-files"></a>Защита файлов конфигурации приложений  
 Файл конфигурации приложения службы может определять, каким образом будут публиковаться метаданные и будут ли они публиковаться в принципе. Рекомендуется защищать файлы конфигурации приложений с помощью списков управления доступом, чтобы злоумышленники не могли изменить параметры в этих файлах.  
  
## <a name="see-also"></a>Дополнительно

- [Практическое руководство. Защита конечных точек метаданных](how-to-secure-metadata-endpoints.md)
- [Безопасность](security.md)
