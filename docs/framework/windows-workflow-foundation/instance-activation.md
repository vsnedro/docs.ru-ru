---
title: Активация экземпляров
ms.date: 03/30/2017
ms.assetid: 134c3f70-5d4e-46d0-9d49-469a6643edd8
ms.openlocfilehash: 1fd30d9d440c06c03e726ed1f1ddbebb0d5f7e8c
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2020
ms.locfileid: "96279939"
---
# <a name="instance-activation"></a>Активация экземпляров

Хранилище экземпляров рабочих процессов SQL работает как внутренняя задача, которая периодически активируется и обнаруживает запускаемые или доступные для действий экземпляры рабочих процессов в базе данных сохраняемости. Если запускаемый экземпляр рабочего процесса найден, хранилище уведомит узел рабочих процессов, который может активировать этот экземпляр. Если хранилище экземпляров найдет доступный экземпляр рабочего процесса, оно уведомит общий узел, который активирует узел рабочих процессов, который в свою очередь запустит экземпляр рабочего процесса. В следующих подразделах этого раздела приводится подробное объяснение процесса активации экземпляра.  
  
## <a name="detecting-and-activating-runnable-workflow-instances"></a><a name="RunnableSection"></a> Обнаружение и активация готовых экземпляров рабочих процессов  

 Хранилище экземпляров рабочих процессов SQL считает, что экземпляр рабочего процесса *готов к запуску* , если экземпляр не находится в состоянии SUSPENDED или Completed и удовлетворяет следующим условиям.  
  
- Экземпляр разблокирован и имеет таймер в состоянии ожидания, время которого истекло.  
  
- Время блокировки экземпляра истекло.  
  
- Экземпляр разблокируется и его состояние — "выполнено **".**  
  
 При обнаружении запускаемого экземпляра хранилище экземпляров рабочих процессов SQL создает событие <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent>. После этого хранилище экземпляров рабочих процессов SQL останавливает наблюдение до однократного вызова <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> на этом хранилище.  
  
 Узел рабочих процессов, который подписался на событие <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> и может загрузить экземпляр, выполняет команду <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> относительно хранилища экземпляров для его загрузки в память. Узел рабочего процесса считается способен загрузить экземпляр рабочего процесса, если для узла и экземпляра свойство Metadata **воркфловсервицетипе** имеет одно и то же значение.  
  
## <a name="detecting-and-activating-activatable-workflow-instances"></a>Обнаружение и активация доступных для действий экземпляров рабочих процессов  

 Экземпляр рабочего процесса считается *активируемого* , если экземпляр готов к запуску и на нем не работает узел рабочего процесса, который способен загрузить экземпляр. Определение экземпляра запускаемого рабочего процесса см. выше, в разделе Обнаружение и активация запускаемых экземпляров рабочих процессов.  
  
 При обнаружении доступного для действий экземпляра рабочего процесса в базе данных хранилище экземпляров рабочих процессов SQL создает событие <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent>. После этого хранилище экземпляров рабочих процессов SQL останавливает наблюдение до однократного вызова <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> на этом хранилище.  
  
 Когда общий узел, подписанный на событие <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent>, получает его, он выполняет команду <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> относительно хранилища экземпляров для получения параметров активации, необходимых для создания узла рабочих процессов. Универсальный узел использует эти параметры для создания приложения рабочего процесса, которое в свою очередь загружает и запускает запускаемый экземпляр службы.  
  
## <a name="generic-hosts"></a>Универсальные узлы  

 Универсальный узел — это узел со значением свойства метаданных **воркфловсервицетипе** для универсальных узлов, установленным в значение **воркфловсервицетипе. Any** , чтобы указать, что он может управлять любым типом рабочего процесса. Универсальный узел имеет параметр XName с именем **активатионтипе**.  
  
 В настоящее время хранилище экземпляров рабочих процессов SQL поддерживает универсальные узлы со значением параметра Активатионтипе, равным **WAS**. Если параметру ActivationType не задано значение WAS, хранилище экземпляров рабочих процессов SQL формирует исключение <xref:System.Runtime.DurableInstancing.InstancePersistenceException>. Служба управления рабочими процессами, входящая в состав компонентов Windows Server AppFabric, является универсальным узлом, для которого тип активации имеет значение **WAS**.  
  
 Для активации WAS универсальному узлу требуется набор параметров активации для выявления адреса конечной точки, по которому можно активировать новые узлы. Параметры для активации WAS ― это имя узла, путь к приложению относительно узла и путь к службе относительно приложения. Хранилище экземпляров рабочих процессов SQL хранит эти параметры активации во время выполнения команды <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>.  
  
## <a name="runnable-instances-detection-period"></a>Период обнаружения запускаемых экземпляров  

 Свойство **периода обнаружения готовых экземпляров** в хранилище экземпляров рабочих процессов SQL определяет период времени, по истечении которого в хранилище экземпляров рабочих процессов SQL выполняется задача обнаружения для обнаружения любых готовых к запуску или активируемого экземпляров рабочих процессов в базе данных сохраняемости после предыдущего цикла обнаружения. Дополнительные сведения об этом свойстве см. в разделе [период обнаружения готовых экземпляров](runnable-instances-detection-period.md) .
