---
title: 'CA2109: Просмотр видимых обработчиков событий (анализ кода)'
description: 'Дополнительные сведения о правиле анализа кода CA2109: Просмотр видимых обработчиков событий'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA2109
- ReviewVisibleEventHandlers
helpviewer_keywords:
- ReviewVisibleEventHandlers
- CA2109
author: gewarren
ms.author: gewarren
ms.openlocfilehash: 8af96fbc56b29d6ea77ebfde11131aa271689c1a
ms.sourcegitcommit: 2e4adc490c1d2a705a0592b295d606b10b9f51f1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2020
ms.locfileid: "96592707"
---
# <a name="ca2109-review-visible-event-handlers"></a>CA2109. Проверьте видимые обработчики событий

| | Значение |
|-|-|
| **Идентификатор правила** |CA2109|
| **Категория** |Microsoft.Security|
| **Исправление не критическое или не критическое** |Критическое|

## <a name="cause"></a>Причина

Обнаружен открытый или защищенный метод обработки событий.

## <a name="rule-description"></a>Описание правила

Внешний видимый метод обработки событий представляет собой проблемы безопасности, требующие проверки.

Не предоставляйте методы обработки событий, если это не обязательно. Обработчик событий, тип делегата, который вызывает предоставленный метод, может быть добавлен к любому событию при условии, что сигнатуры обработчика и события совпадают. События потенциально могут вызываться любым кодом и часто вызываются в системном коде с высоким уровнем доверия в ответ на действия пользователя, такие как нажатие кнопки. Добавление проверки безопасности в метод обработки событий не мешает коду зарегистрировать обработчик событий, который вызывает метод.

Запрос не может надежно защищать метод, вызываемый обработчиком событий. Требования безопасности помогают защитить код от ненадежных вызывающих объектов путем проверки вызывающих объектов в стеке вызовов. Код, который добавляет обработчик событий в событие, не всегда имеется в стеке вызовов при выполнении методов обработчика событий. Поэтому стек вызовов может иметь только высоко доверенные вызывающие объекты при вызове метода обработчика событий. Это приводит к выполнению запросов, выполненных методом обработчика событий. Кроме того, запрошенное разрешение может быть утверждено при вызове метода. По этим причинам риск отсутствия исправления этого правила можно оценить только после просмотра метода обработки событий. При проверке кода учитывайте следующие моменты.

- Выполняет ли обработчик событий любые операции, которые опасны или могут использовать злоумышленники, такие как утверждение разрешений или подавление разрешения на неуправляемый код?

- Каковы угрозы безопасности для кода и из него, так как они могут запускаться в любое время с очень надежными вызывающими объектами в стеке?

## <a name="how-to-fix-violations"></a>Устранение нарушений

Чтобы устранить нарушение этого правила, изучите метод и проверьте следующее:

- Можно ли сделать метод обработки событий не открытым?

- Можно ли переместить все опасные функции из обработчика событий?

- Если вы накладываете требование безопасности, то можете ли это сделать другим способом?

## <a name="when-to-suppress-warnings"></a>Когда следует подавлять предупреждения

Подавлять предупреждение из этого правила только после тщательного анализа безопасности, чтобы убедиться в том, что код не создает угрозу безопасности.

## <a name="example"></a>Пример

В следующем коде показан метод обработки событий, который может быть неправильно использован вредоносным кодом.

:::code language="csharp" source="snippets/csharp/all-rules/ca2109.cs" id="snippet1":::

## <a name="see-also"></a>См. также

- <xref:System.Security.CodeAccessPermission.Demand%2A?displayProperty=fullName>
- <xref:System.EventArgs?displayProperty=fullName>
