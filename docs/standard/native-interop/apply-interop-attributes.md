---
title: Применение атрибутов взаимодействия
description: В этой статье перечислены атрибуты COM-взаимодействия пространства имен System.Runtime.InteropServices, в том числе атрибуты времени разработки и средства преобразования.
ms.date: 03/30/2017
helpviewer_keywords:
- design-time attributes
- .NET Framework, exposing components to COM
- attributes [.NET Framework], design-time functionality
- conversion-tool attributes
- attributes [.NET Framework], interop-specific
- attributes [.NET Framework], conversion-tool
- interoperation with unmanaged code, applying attributes
- interoperation with unmanaged code, exposing .NET Framework components
- COM interop, exposing COM components
- COM interop, applying attributes
ms.assetid: b6014613-641c-4912-9e2f-83a99210a037
ms.openlocfilehash: f9ccf59e52c1ef27649cd70a57f7b24bb5a8e9bf
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/02/2020
ms.locfileid: "84291335"
---
# <a name="applying-interop-attributes"></a><span data-ttu-id="81adf-103">Применение атрибутов взаимодействия</span><span class="sxs-lookup"><span data-stu-id="81adf-103">Applying Interop Attributes</span></span>
<span data-ttu-id="81adf-104">В пространстве имен <xref:System.Runtime.InteropServices> представлены три категории атрибутов взаимодействия: атрибуты, применяемые разработчиком во время разработки, API и средствами COM-взаимодействия в процессе преобразования, а также разработчиком или средой COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-104">The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.</span></span>  
  
 <span data-ttu-id="81adf-105">Дополнительные сведения о применении атрибутов к управляемому коду см. в разделе [Расширение метаданных с помощью атрибутов](../attributes/index.md).</span><span class="sxs-lookup"><span data-stu-id="81adf-105">If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../attributes/index.md).</span></span> <span data-ttu-id="81adf-106">Как и другие настраиваемые атрибуты, атрибуты взаимодействия можно применять к типам, методам, свойствам, параметрам, полям и другим членам.</span><span class="sxs-lookup"><span data-stu-id="81adf-106">Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.</span></span>  
  
## <a name="design-time-attributes"></a><span data-ttu-id="81adf-107">Атрибуты времени разработки</span><span class="sxs-lookup"><span data-stu-id="81adf-107">Design-Time Attributes</span></span>  
 <span data-ttu-id="81adf-108">Атрибуты времени разработки позволяют настраивать результаты процесса преобразования, который выполняется API и средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-108">You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.</span></span> <span data-ttu-id="81adf-109">В следующей таблице описываются атрибуты, которые можно применять к управляемому исходному коду.</span><span class="sxs-lookup"><span data-stu-id="81adf-109">The following table describes the attributes that you can apply to your managed source code.</span></span> <span data-ttu-id="81adf-110">В некоторых случаях средства COM-взаимодействия также могут применять описываемые здесь атрибуты.</span><span class="sxs-lookup"><span data-stu-id="81adf-110">COM interop tools, on occasion, might also apply the attributes described in this table.</span></span>  
  
|<span data-ttu-id="81adf-111">Атрибут</span><span class="sxs-lookup"><span data-stu-id="81adf-111">Attribute</span></span>|<span data-ttu-id="81adf-112">Описание</span><span class="sxs-lookup"><span data-stu-id="81adf-112">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|<span data-ttu-id="81adf-113">Указывает, будет ли выполняться маршалинг типа с использованием маршалера автоматизации или настраиваемого прокси-сервера и заглушки.</span><span class="sxs-lookup"><span data-stu-id="81adf-113">Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.</span></span>|  
|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|<span data-ttu-id="81adf-114">Определяет тип интерфейса, создаваемого для класса.</span><span class="sxs-lookup"><span data-stu-id="81adf-114">Controls the type of interface generated for a class.</span></span>|  
|<xref:System.Runtime.InteropServices.CoClassAttribute>|<span data-ttu-id="81adf-115">Указывает идентификатор CLSID исходного компонентного класса, импортированного из библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="81adf-115">Identifies the CLSID of the original coclass imported from a type library.</span></span><br /><br /> <span data-ttu-id="81adf-116">Этот атрибут обычно применяется средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-116">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComImportAttribute>|<span data-ttu-id="81adf-117">Указывает, что определение компонентного класса или интерфейса было импортировано из библиотеки типов COM.</span><span class="sxs-lookup"><span data-stu-id="81adf-117">Indicates that a coclass or interface definition was imported from a COM type library.</span></span> <span data-ttu-id="81adf-118">Этот флаг используется средой выполнения, чтобы определить способ активации и маршалинга типа.</span><span class="sxs-lookup"><span data-stu-id="81adf-118">The runtime uses this flag to know how to activate and marshal the type.</span></span> <span data-ttu-id="81adf-119">Этот атрибут запрещает экспорт обратно в библиотеку типов.</span><span class="sxs-lookup"><span data-stu-id="81adf-119">This attribute prohibits the type from being exported back to a type library.</span></span><br /><br /> <span data-ttu-id="81adf-120">Этот атрибут обычно применяется средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-120">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|<span data-ttu-id="81adf-121">Указывает, что метод должен вызываться при регистрации сборки для использования из модели COM, что позволяет выполнять написанный пользователем код в процессе регистрации.</span><span class="sxs-lookup"><span data-stu-id="81adf-121">Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|<span data-ttu-id="81adf-122">Определяет интерфейсы, являющиеся источниками событий для класса.</span><span class="sxs-lookup"><span data-stu-id="81adf-122">Identifies interfaces that are sources of events for the class.</span></span><br /><br /> <span data-ttu-id="81adf-123">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-123">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|<span data-ttu-id="81adf-124">Указывает, что метод должен вызываться при отмене регистрации сборки для использования из модели COM, что позволяет выполнять написанный пользователем код в ходе этого процесса.</span><span class="sxs-lookup"><span data-stu-id="81adf-124">Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|<span data-ttu-id="81adf-125">Если значение атрибута равно **false**, отображает типы, невидимые для модели COM.</span><span class="sxs-lookup"><span data-stu-id="81adf-125">Renders types invisible to COM when the attribute value equals **false**.</span></span> <span data-ttu-id="81adf-126">Этот атрибут может применяться к отдельному типу или ко всей сборке для управления видимостью COM.</span><span class="sxs-lookup"><span data-stu-id="81adf-126">This attribute can be applied to an individual type or to an entire assembly to control COM visibility.</span></span> <span data-ttu-id="81adf-127">По умолчанию все управляемые открытые типы являются видимыми, и использовать этот атрибут не нужно.</span><span class="sxs-lookup"><span data-stu-id="81adf-127">By default, all managed, public types are visible; the attribute is not needed to make them visible.</span></span>|  
|<xref:System.Runtime.InteropServices.DispIdAttribute>|<span data-ttu-id="81adf-128">Указывает идентификатор диспетчера COM (DISPID) для метода или поля.</span><span class="sxs-lookup"><span data-stu-id="81adf-128">Specifies the COM dispatch identifier (DISPID) of a method or field.</span></span> <span data-ttu-id="81adf-129">Этот атрибут содержит идентификатор DISPID для метода, поля или свойства, которые он описывает.</span><span class="sxs-lookup"><span data-stu-id="81adf-129">This attribute contains the DISPID for the method, field, or property it describes.</span></span><br /><br /> <span data-ttu-id="81adf-130">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-130">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.ComDefaultInterfaceAttribute>|<span data-ttu-id="81adf-131">Определяет интерфейс по умолчанию для COM-класса, реализованного в .NET.</span><span class="sxs-lookup"><span data-stu-id="81adf-131">Indicates the default interface for a COM class implemented in .NET.</span></span><br /><br /> <span data-ttu-id="81adf-132">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-132">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|<span data-ttu-id="81adf-133">Указывает физическое расположение каждого поля в классе при использовании с атрибутом **StructLayoutAttribute**, если атрибуту **LayoutKind** присвоено значение Explicit.</span><span class="sxs-lookup"><span data-stu-id="81adf-133">Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit.</span></span>|  
|<xref:System.Runtime.InteropServices.GuidAttribute>|<span data-ttu-id="81adf-134">Указывает глобальный уникальный идентификатор (GUID) класса, интерфейса или всей библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="81adf-134">Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.</span></span> <span data-ttu-id="81adf-135">Строка, передаваемая атрибуту, должна иметь формат допустимого аргумента конструктора для типа **System.Guid**.</span><span class="sxs-lookup"><span data-stu-id="81adf-135">The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.</span></span><br /><br /> <span data-ttu-id="81adf-136">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-136">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|<span data-ttu-id="81adf-137">Указывает, какую реализацию интерфейса **IDispatch** общеязыковая среда выполнения использует при предоставлении dual- и disp-интерфейсов для модели COM.</span><span class="sxs-lookup"><span data-stu-id="81adf-137">Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.</span></span>|  
|<xref:System.Runtime.InteropServices.InAttribute>|<span data-ttu-id="81adf-138">Указывает, что данные необходимо маршалировать в вызывающий объект.</span><span class="sxs-lookup"><span data-stu-id="81adf-138">Indicates that data should be marshaled in to the caller.</span></span> <span data-ttu-id="81adf-139">Может использоваться в качестве атрибута параметров.</span><span class="sxs-lookup"><span data-stu-id="81adf-139">Can be used to attribute parameters.</span></span>|  
|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|<span data-ttu-id="81adf-140">Определяет, как управляемый интерфейс предоставляется клиентам COM (dual, производный от IUnknown или только IDispatch).</span><span class="sxs-lookup"><span data-stu-id="81adf-140">Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).</span></span><br /><br /> <span data-ttu-id="81adf-141">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-141">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|<span data-ttu-id="81adf-142">Указывает, что в сигнатуре неуправляемого метода требуется параметр кода языка (LCID).</span><span class="sxs-lookup"><span data-stu-id="81adf-142">Indicates that an unmanaged method signature expects an LCID parameter.</span></span><br /><br /> <span data-ttu-id="81adf-143">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-143">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|<span data-ttu-id="81adf-144">Указывает способ маршалинга данных полей или параметров между управляемым и неуправляемым кодом.</span><span class="sxs-lookup"><span data-stu-id="81adf-144">Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.</span></span> <span data-ttu-id="81adf-145">Этот атрибут всегда является необязательным, поскольку для каждого типа данных определено поведение маршалинга по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="81adf-145">The attribute is always optional because each data type has default marshaling behavior.</span></span><br /><br /> <span data-ttu-id="81adf-146">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-146">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OptionalAttribute>|<span data-ttu-id="81adf-147">Указывает, что параметр является необязательным.</span><span class="sxs-lookup"><span data-stu-id="81adf-147">Indicates that a parameter is optional.</span></span><br /><br /> <span data-ttu-id="81adf-148">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-148">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OutAttribute>|<span data-ttu-id="81adf-149">Указывает, что данные поля или параметра должны маршалироваться из вызываемого объекта обратно в вызывающий.</span><span class="sxs-lookup"><span data-stu-id="81adf-149">Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.</span></span>|  
|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|<span data-ttu-id="81adf-150">Подавляет преобразование значения HRESULT или сигнатуры retval, которое обычно выполняется во время вызовов взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-150">Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.</span></span> <span data-ttu-id="81adf-151">Этот атрибут влияет на маршалинг и экспорт библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="81adf-151">The attribute affects marshaling as well as type library exporting.</span></span><br /><br /> <span data-ttu-id="81adf-152">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-152">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ProgIdAttribute>|<span data-ttu-id="81adf-153">Указывает идентификатор ProgID для класса .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="81adf-153">Specifies the ProgID of a .NET Framework class.</span></span> <span data-ttu-id="81adf-154">Может использоваться в качестве атрибута классов.</span><span class="sxs-lookup"><span data-stu-id="81adf-154">Can be used to attribute classes.</span></span>|  
|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|<span data-ttu-id="81adf-155">Управляет физической компоновкой полей класса.</span><span class="sxs-lookup"><span data-stu-id="81adf-155">Controls the physical layout of the fields of a class.</span></span><br /><br /> <span data-ttu-id="81adf-156">Этот атрибут может применяться средствами COM-взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="81adf-156">COM interop tools can apply this attribute.</span></span>|  
  
## <a name="conversion-tool-attributes"></a><span data-ttu-id="81adf-157">Атрибуты средств преобразования</span><span class="sxs-lookup"><span data-stu-id="81adf-157">Conversion-Tool Attributes</span></span>  
 <span data-ttu-id="81adf-158">В следующей таблице описываются атрибуты, которые применяются средствами COM-взаимодействия во время преобразования.</span><span class="sxs-lookup"><span data-stu-id="81adf-158">The following table describes attributes that COM interop tools apply during the conversion process.</span></span> <span data-ttu-id="81adf-159">Эти атрибуты не применяются во время разработки.</span><span class="sxs-lookup"><span data-stu-id="81adf-159">You do not apply these attributes at design time.</span></span>  
  
|<span data-ttu-id="81adf-160">Атрибут</span><span class="sxs-lookup"><span data-stu-id="81adf-160">Attribute</span></span>|<span data-ttu-id="81adf-161">Описание</span><span class="sxs-lookup"><span data-stu-id="81adf-161">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|<span data-ttu-id="81adf-162">Указывает псевдоним COM для типа параметра или поля.</span><span class="sxs-lookup"><span data-stu-id="81adf-162">Indicates the COM alias for a parameter or field type.</span></span> <span data-ttu-id="81adf-163">Может использоваться в качестве атрибута параметров, полей или возвращаемых значений.</span><span class="sxs-lookup"><span data-stu-id="81adf-163">Can be used to attribute parameters, fields, or return values.</span></span>|  
|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|<span data-ttu-id="81adf-164">Указывает, что сведения о классе или интерфейсе были потеряны при импорте из библиотеки типов в сборку.</span><span class="sxs-lookup"><span data-stu-id="81adf-164">Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.</span></span>|  
|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|<span data-ttu-id="81adf-165">Определяет исходный интерфейс и класс, реализующие методы интерфейса событий.</span><span class="sxs-lookup"><span data-stu-id="81adf-165">Identifies the source interface and the class that implements the methods of the event interface.</span></span>|  
|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|<span data-ttu-id="81adf-166">Указывает, что сборка была первоначально импортирована из библиотеки типов COM.</span><span class="sxs-lookup"><span data-stu-id="81adf-166">Indicates that the assembly was originally imported from a COM type library.</span></span> <span data-ttu-id="81adf-167">Этот атрибут содержит определение исходной библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="81adf-167">This attribute contains the type library definition of the original type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|<span data-ttu-id="81adf-168">Содержит флаги **FUNCFLAGS**, которые были первоначально импортированы для этой функции из библиотеки типов COM.</span><span class="sxs-lookup"><span data-stu-id="81adf-168">Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|<span data-ttu-id="81adf-169">Содержит флаги **TYPEFLAGS**, которые были первоначально импортированы для этого типа из библиотеки типов COM.</span><span class="sxs-lookup"><span data-stu-id="81adf-169">Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|<span data-ttu-id="81adf-170">Содержит флаги **VARFLAGS**, которые были первоначально импортированы для этой переменной из библиотеки типов COM.</span><span class="sxs-lookup"><span data-stu-id="81adf-170">Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="81adf-171">См. также</span><span class="sxs-lookup"><span data-stu-id="81adf-171">See also</span></span>

- <xref:System.Runtime.InteropServices>
- [<span data-ttu-id="81adf-172">Предоставление компонентов .NET Framework клиентам COM</span><span class="sxs-lookup"><span data-stu-id="81adf-172">Exposing .NET Framework Components to COM</span></span>](../../framework/interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="81adf-173">Атрибуты</span><span class="sxs-lookup"><span data-stu-id="81adf-173">Attributes</span></span>](../attributes/index.md)
- [<span data-ttu-id="81adf-174">Oпределение типов .NET для взаимодействия</span><span class="sxs-lookup"><span data-stu-id="81adf-174">Qualifying .NET Types for Interoperation</span></span>](qualify-net-types-for-interoperation.md)
- [<span data-ttu-id="81adf-175">Упаковка сборки .NET Framework для COM</span><span class="sxs-lookup"><span data-stu-id="81adf-175">Packaging a .NET Framework Assembly for COM</span></span>](../../framework/interop/packaging-an-assembly-for-com.md)
