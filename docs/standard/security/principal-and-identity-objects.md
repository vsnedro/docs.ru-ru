---
title: Объекты Principal и Identity
description: Ознакомьтесь с объектами Identity, которые представляют пользователей в .NET. Также ознакомьтесь с основными объектами, которые инкапсулируют объект Identity & роли.
ms.date: 07/15/2020
helpviewer_keywords:
- WindowsIdentity objects
- GenericIdentity objects
- GenericPrincipal objects
- identity objects, about identity objects
- security [.NET], identity objects
- principal objects, about principal objects
- security [.NET], principals
- WindowsPrincipal objects
ms.assetid: aa5930ad-f3d7-40aa-b6f6-c6edcd5c64f7
ms.openlocfilehash: cfda506fc29e9a86e97b3c99faf2d4155c894f03
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2020
ms.locfileid: "94824243"
---
# <a name="principal-and-identity-objects"></a><span data-ttu-id="56b2b-104">Объекты Principal и Identity</span><span class="sxs-lookup"><span data-stu-id="56b2b-104">Principal and Identity Objects</span></span>

> [!NOTE]
> <span data-ttu-id="56b2b-105">Эта статья относится к Windows.</span><span class="sxs-lookup"><span data-stu-id="56b2b-105">This article applies to Windows.</span></span>
>
> <span data-ttu-id="56b2b-106">Сведения о ASP.NET Core см. в разделе [ASP.NET Core Security](/aspnet/core/security/).</span><span class="sxs-lookup"><span data-stu-id="56b2b-106">For information about ASP.NET Core, see [ASP.NET Core Security](/aspnet/core/security/).</span></span>

<span data-ttu-id="56b2b-107">Управляемый код может обнаружить удостоверение или роль участника с помощью <xref:System.Security.Principal.IPrincipal> объекта, который содержит ссылку на <xref:System.Security.Principal.IIdentity> объект.</span><span class="sxs-lookup"><span data-stu-id="56b2b-107">Managed code can discover the identity or the role of a principal through a <xref:System.Security.Principal.IPrincipal> object, which contains a reference to an <xref:System.Security.Principal.IIdentity> object.</span></span> <span data-ttu-id="56b2b-108">Может быть полезно сравнить объекты Identity и Principal с привычными понятиями, такими как учетные записи пользователей и групп.</span><span class="sxs-lookup"><span data-stu-id="56b2b-108">It might be helpful to compare identity and principal objects to familiar concepts like user and group accounts.</span></span> <span data-ttu-id="56b2b-109">В большинстве сетевых сред учетные записи пользователей представляют пользователей или программы, а учетные записи групп — определенные категории пользователей и предоставленные им права.</span><span class="sxs-lookup"><span data-stu-id="56b2b-109">In most network environments, user accounts represent people or programs, while group accounts represent certain categories of users and the rights they possess.</span></span> <span data-ttu-id="56b2b-110">Аналогичным образом объекты удостоверений .NET представляют пользователей, а роли представляют членства и контексты безопасности.</span><span class="sxs-lookup"><span data-stu-id="56b2b-110">Similarly, .NET identity objects represent users, while roles represent memberships and security contexts.</span></span> <span data-ttu-id="56b2b-111">В .NET объект Principal инкапсулирует как объект Identity, так и роль.</span><span class="sxs-lookup"><span data-stu-id="56b2b-111">In .NET, the principal object encapsulates both an identity object and a role.</span></span> <span data-ttu-id="56b2b-112">Приложения .NET предоставляют участникам права на основе удостоверения или, как правило, членства в роли.</span><span class="sxs-lookup"><span data-stu-id="56b2b-112">.NET applications grant rights to the principal based on its identity or, more commonly, its role membership.</span></span>  
  
## <a name="identity-objects"></a><span data-ttu-id="56b2b-113">Объекты Identity</span><span class="sxs-lookup"><span data-stu-id="56b2b-113">Identity Objects</span></span>

<span data-ttu-id="56b2b-114">Identity — объект инкапсулирует сведения о проверяемом пользователе или сущности.</span><span class="sxs-lookup"><span data-stu-id="56b2b-114">The identity object encapsulates information about the user or entity being validated.</span></span> <span data-ttu-id="56b2b-115">На самом базовом уровне объект Identity содержит имя и тип проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="56b2b-115">At their most basic level, identity objects contain a name and an authentication type.</span></span> <span data-ttu-id="56b2b-116">В качестве имени может использоваться имя пользователя или учетной записи Windows, тогда как типом проверки подлинности может быть поддерживаемый протокол входа в систему, например Kerberos V5 или пользовательское значение.</span><span class="sxs-lookup"><span data-stu-id="56b2b-116">The name can either be a user's name or the name of a Windows account, while the authentication type can be either a supported logon protocol, such as Kerberos V5, or a custom value.</span></span> <span data-ttu-id="56b2b-117">.NET определяет <xref:System.Security.Principal.GenericIdentity> объект, который можно использовать для большинства сценариев входа в систему, и более специализированный <xref:System.Security.Principal.WindowsIdentity> объект, который можно использовать, если приложение должно полагаться на проверку подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="56b2b-117">.NET defines a <xref:System.Security.Principal.GenericIdentity> object that can be used for most custom logon scenarios and a more specialized <xref:System.Security.Principal.WindowsIdentity> object that can be used when you want your application to rely on Windows authentication.</span></span> <span data-ttu-id="56b2b-118">Кроме того, можно определить свой собственный класс Identity, который инкапсулирует особую информацию пользователя.</span><span class="sxs-lookup"><span data-stu-id="56b2b-118">Additionally, you can define your own identity class that encapsulates custom user information.</span></span>  
  
<span data-ttu-id="56b2b-119"><xref:System.Security.Principal.IIdentity>Интерфейс определяет свойства для доступа к имени и типу проверки подлинности, например Kerberos V5 или NTLM.</span><span class="sxs-lookup"><span data-stu-id="56b2b-119">The <xref:System.Security.Principal.IIdentity> interface defines properties for accessing a name and an authentication type, such as Kerberos V5 or NTLM.</span></span> <span data-ttu-id="56b2b-120">Все классы **Identity** реализуют интерфейс **IIdentity**.</span><span class="sxs-lookup"><span data-stu-id="56b2b-120">All **Identity** classes implement the **IIdentity** interface.</span></span> <span data-ttu-id="56b2b-121">Между объектом **Identity** и токеном процесса Windows NT, под которым выполняется текущий поток, необходимой связи нет.</span><span class="sxs-lookup"><span data-stu-id="56b2b-121">There is no required relationship between an **Identity** object and the Windows NT process token under which a thread is currently executing.</span></span> <span data-ttu-id="56b2b-122">Однако, если объектом **Identity** является объект **WindowsIdentity**, предполагается, что Identity представляет токен безопасности Windows NT.</span><span class="sxs-lookup"><span data-stu-id="56b2b-122">However, if the **Identity** object is a **WindowsIdentity** object, the identity is assumed to represent a Windows NT security token.</span></span>  
  
## <a name="principal-objects"></a><span data-ttu-id="56b2b-123">Объекты Principal</span><span class="sxs-lookup"><span data-stu-id="56b2b-123">Principal Objects</span></span>

<span data-ttu-id="56b2b-124">Объект Principal, представляющий контекст безопасности, в котором работает код.</span><span class="sxs-lookup"><span data-stu-id="56b2b-124">The principal object represents the security context under which code is running.</span></span> <span data-ttu-id="56b2b-125">Приложения, реализующие безопасность на основе ролей, предоставляют права на основании роли, связанной с объектом Principal.</span><span class="sxs-lookup"><span data-stu-id="56b2b-125">Applications that implement role-based security grant rights based on the role associated with a principal object.</span></span> <span data-ttu-id="56b2b-126">Как и объекты Identity, .NET предоставляет <xref:System.Security.Principal.GenericPrincipal> объект и <xref:System.Security.Principal.WindowsPrincipal> объект.</span><span class="sxs-lookup"><span data-stu-id="56b2b-126">Similar to identity objects, .NET provides a <xref:System.Security.Principal.GenericPrincipal> object and a <xref:System.Security.Principal.WindowsPrincipal> object.</span></span> <span data-ttu-id="56b2b-127">Можно также определить собственные пользовательские классы Principal.</span><span class="sxs-lookup"><span data-stu-id="56b2b-127">You can also define your own custom principal classes.</span></span>  
  
<span data-ttu-id="56b2b-128"><xref:System.Security.Principal.IPrincipal>Интерфейс определяет свойство для доступа к связанному объекту **Identity** , а также метод для определения того, является ли пользователь, определяемый объектом **Principal** , членом данной роли.</span><span class="sxs-lookup"><span data-stu-id="56b2b-128">The <xref:System.Security.Principal.IPrincipal> interface defines a property for accessing an associated **Identity** object as well as a method for determining whether the user identified by the **Principal** object is a member of a given role.</span></span> <span data-ttu-id="56b2b-129">Все классы **Principal** реализуют интерфейс **IPrincipal**, а также любые необходимые дополнительные свойства и методы.</span><span class="sxs-lookup"><span data-stu-id="56b2b-129">All **Principal** classes implement the **IPrincipal** interface as well as any additional properties and methods that are necessary.</span></span> <span data-ttu-id="56b2b-130">Например, среда CLR предоставляет класс **WindowsPrincipal**, который обеспечивает дополнительные функциональные возможности для сопоставления членства в группе Windows NT или Windows 2000 с ролями.</span><span class="sxs-lookup"><span data-stu-id="56b2b-130">For example, the common language runtime provides the **WindowsPrincipal** class, which implements additional functionality for mapping Windows NT or Windows 2000 group membership to roles.</span></span>  
  
<span data-ttu-id="56b2b-131">Объект **Principal** привязан к объекту контекста вызова ( <xref:System.Runtime.Remoting.Messaging.CallContext> ) в домене приложения ( <xref:System.AppDomain> ).</span><span class="sxs-lookup"><span data-stu-id="56b2b-131">A **Principal** object is bound to a call context (<xref:System.Runtime.Remoting.Messaging.CallContext>) object within an application domain (<xref:System.AppDomain>).</span></span> <span data-ttu-id="56b2b-132">Контекст вызова по умолчанию всегда создается с каждым новым **AppDomain**, поэтому всегда доступен контекст вызова для принятия объекта **Principal** .</span><span class="sxs-lookup"><span data-stu-id="56b2b-132">A default call context is always created with each new **AppDomain**, so there is always a call context available to accept the **Principal** object.</span></span> <span data-ttu-id="56b2b-133">При создании нового потока для него также создается объект **CallContext**.</span><span class="sxs-lookup"><span data-stu-id="56b2b-133">When a new thread is created, a **CallContext** object is also created for the thread.</span></span> <span data-ttu-id="56b2b-134">Ссылка на объект **Principal** автоматически копируется из создаваемого потока в объект **CallContext** нового потока.</span><span class="sxs-lookup"><span data-stu-id="56b2b-134">The **Principal** object reference is automatically copied from the creating thread to the new thread's **CallContext**.</span></span> <span data-ttu-id="56b2b-135">Если среда выполнения не может определить, какой объект **Principal** принадлежит создателю потока, она применяет политику по умолчанию для создания объектов **Principal** и **Identity**.</span><span class="sxs-lookup"><span data-stu-id="56b2b-135">If the runtime cannot determine which **Principal** object belongs to the creator of the thread, it follows the default policy for **Principal** and **Identity** object creation.</span></span>  
  
<span data-ttu-id="56b2b-136">Настраиваемая политика для домена приложения определяет правила выбора типа объекта **Principal** для связи с новым доменом приложения.</span><span class="sxs-lookup"><span data-stu-id="56b2b-136">A configurable application domain-specific policy defines the rules for deciding what type of **Principal** object to associate with a new application domain.</span></span> <span data-ttu-id="56b2b-137">Если позволяет политика безопасности, среда выполнения может создать объекты **Principal** и **Identity**, которые отражают токен операционной системы, связанный с текущим потоком выполнения.</span><span class="sxs-lookup"><span data-stu-id="56b2b-137">Where security policy permits, the runtime can create **Principal** and **Identity** objects that reflect the operating system token associated with the current thread of execution.</span></span> <span data-ttu-id="56b2b-138">По умолчанию среда выполнения использует объекты **Principal** и **Identity**, представляющие пользователей, не прошедших проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="56b2b-138">By default, the runtime uses **Principal** and **Identity** objects that represent unauthenticated users.</span></span> <span data-ttu-id="56b2b-139">Среда выполнения не создаст такие объекты **Principal** и **Identity**, пока код не попытается получить к ним доступ.</span><span class="sxs-lookup"><span data-stu-id="56b2b-139">The runtime does not create these default **Principal** and **Identity** objects until the code attempts to access them.</span></span>  
  
<span data-ttu-id="56b2b-140">Доверенный код, создающий домен приложения, может установить политику домена приложения, которая управляет процессом создания объектов по умолчанию **Principal** и **Identity**.</span><span class="sxs-lookup"><span data-stu-id="56b2b-140">Trusted code that creates an application domain can set the application domain policy that controls construction of the default **Principal** and **Identity** objects.</span></span> <span data-ttu-id="56b2b-141">Такая политика домена приложения применяется ко всем выполняемым потокам в данном домене приложения.</span><span class="sxs-lookup"><span data-stu-id="56b2b-141">This application domain-specific policy applies to all execution threads in that application domain.</span></span> <span data-ttu-id="56b2b-142">Неуправляемый доверенный узел по сути имеет возможность установить эту политику, но управляемый код, задающий эту политику, должен иметь <xref:System.Security.Permissions.SecurityPermission?displayProperty=nameWithType> для управления политикой домена.</span><span class="sxs-lookup"><span data-stu-id="56b2b-142">An unmanaged, trusted host inherently has the ability to set this policy, but managed code that sets this policy must have the <xref:System.Security.Permissions.SecurityPermission?displayProperty=nameWithType> for controlling domain policy.</span></span>  
  
<span data-ttu-id="56b2b-143">При передаче объекта **Principal** через домены приложений, но в рамках одного процесса (и, следовательно, на том же компьютере), инфраструктура удаленного взаимодействия копирует ссылку на объект **Principal**, связанный с контекстом вызывающей функции, в вызываемую функцию.</span><span class="sxs-lookup"><span data-stu-id="56b2b-143">When transmitting a **Principal** object across application domains but within the same process (and therefore on the same computer), the remoting infrastructure copies a reference to the **Principal** object associated with the caller's context to the callee's context.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="56b2b-144">См. также статью</span><span class="sxs-lookup"><span data-stu-id="56b2b-144">See also</span></span>

- [<span data-ttu-id="56b2b-145">Практическое руководство. Создание объекта WindowsPrincipal</span><span class="sxs-lookup"><span data-stu-id="56b2b-145">How to: Create a WindowsPrincipal Object</span></span>](how-to-create-a-windowsprincipal-object.md)
- [<span data-ttu-id="56b2b-146">Практическое руководство. Создание объектов GenericPrincipal и GenericIdentity</span><span class="sxs-lookup"><span data-stu-id="56b2b-146">How to: Create GenericPrincipal and GenericIdentity Objects</span></span>](how-to-create-genericprincipal-and-genericidentity-objects.md)
- [<span data-ttu-id="56b2b-147">Замена объекта Principal</span><span class="sxs-lookup"><span data-stu-id="56b2b-147">Replacing a Principal Object</span></span>](replacing-a-principal-object.md)
- [<span data-ttu-id="56b2b-148">Олицетворение и возвращение</span><span class="sxs-lookup"><span data-stu-id="56b2b-148">Impersonating and Reverting</span></span>](impersonating-and-reverting.md)
- [<span data-ttu-id="56b2b-149">Безопасность на основе ролей</span><span class="sxs-lookup"><span data-stu-id="56b2b-149">Role-Based Security</span></span>](role-based-security.md)
- [<span data-ttu-id="56b2b-150">Основные понятия безопасности</span><span class="sxs-lookup"><span data-stu-id="56b2b-150">Key Security Concepts</span></span>](key-security-concepts.md)
- [<span data-ttu-id="56b2b-151">Безопасность ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="56b2b-151">ASP.NET Core Security</span></span>](/aspnet/core/security/)
