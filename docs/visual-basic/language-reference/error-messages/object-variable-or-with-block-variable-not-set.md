---
title: Не задана переменная объекта или переменная блока With
ms.date: 07/20/2015
f1_keywords:
- vbrID91
ms.assetid: 2f03e611-f0ed-465c-99a2-a816e034faa3
ms.openlocfilehash: d1778e2bb58d32e976f10b3fba1637918278d36e
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2020
ms.locfileid: "84409287"
---
# <a name="object-variable-or-with-block-variable-not-set"></a>Не задана переменная объекта или переменная блока With
Указана недопустимая объектная переменная.   Эта ошибка может возникать по нескольким причинам:

- Переменная объявлена без указания типа. Если переменная объявлена без указания типа, по умолчанию используется тип `Object` .

    Например, переменная, объявленная с `Dim x` типом, будет иметь тип `Object;` переменной, объявленной с `Dim x As String` типом `String` .

    > [!TIP]
    > `Option Strict`Оператор запрещает неявную типизацию, которая приводит к `Object` типу. Если опустить тип, возникнет ошибка времени компиляции. См. раздел [Оператор Option Strict](../statements/option-strict-statement.md).

- Предпринимается попытка сослаться на объект, для которого задано значение `Nothing` .

- Предпринята попытка получить доступ к элементу переменной массива, которая была неправильно объявлена.

    Например, массив, объявленный как, `products() As String` вызовет ошибку при попытке сослаться на элемент массива `products(3) = "Widget"` . Массив не содержит элементов и обрабатывается как объект.

- Попытка получить доступ к коду в `With...End With` блоке до инициализации блока.   `With...End With`Блок необходимо инициализировать, выполнив `With` точку входа оператора.

> [!NOTE]
> В более ранних версиях Visual Basic или VBA эта ошибка также была активирована путем присвоения значения переменной без использования `Set` ключевого слова ( `x = "name"` вместо `Set x = "name"` ). `Set`Ключевое слово больше не является допустимым в Visual Basic .NET.

## <a name="to-correct-this-error"></a>Исправление ошибки

1. Задайте `Option Strict` для значение `On` , добавив следующий код в начало файла:

    ```vb
    Option Strict On
    ```

    При запуске проекта в **Список ошибок** для любой переменной, указанной без типа, отобразится ошибка компилятора.

2. Если вы не хотите включать `Option Strict` , найдите в коде любые переменные, которые были указаны без типа ( `Dim x` вместо `Dim x As String` ), и добавьте предполагаемый тип к объявлению.

3. Убедитесь, что вы не ссылаетесь на переменную объекта, для которой было задано значение `Nothing` .  Найдите ключевое слово в коде `Nothing` и измените код таким образом, чтобы объект не был установлен в значение `Nothing` до тех пор, пока вы не задали ссылку на него.

4. Прежде чем обращаться к ним, убедитесь, что все переменные массива имеют размеры. Можно либо назначить измерение при первом создании массива ( `Dim x(5) As String` вместо `Dim x() As String` ), либо использовать `ReDim` ключевое слово, чтобы задать размеры массива до первого доступа к нему.

5. Убедитесь, что `With` блок инициализирован путем выполнения `With` точки входа оператора.

## <a name="see-also"></a>См. также раздел

- [Объявление объектной переменной](../../programming-guide/language-features/variables/object-variable-declaration.md)
- [Оператор reDim](../statements/redim-statement.md)
- [Оператор With…End With](../statements/with-end-with-statement.md)
