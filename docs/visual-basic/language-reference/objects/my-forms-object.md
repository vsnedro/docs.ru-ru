---
title: Объект My.Forms
ms.date: 07/20/2015
f1_keywords:
- My.Forms
- My.MyProject.Forms
helpviewer_keywords:
- My.Forms object
ms.assetid: f6bff4e6-6769-4294-956b-037aa6106d2a
ms.openlocfilehash: 001f6fbfae2467ea0af5e98ca041b694d1e7b8f9
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2020
ms.locfileid: "84372444"
---
# <a name="myforms-object"></a>Объект My.Forms

Предоставляет свойства для доступа к экземпляру каждой формы Windows Form, объявленной в текущем проекте.

## <a name="remarks"></a>Комментарии

`My.Forms`Объект предоставляет экземпляр каждой формы в текущем проекте. Имя свойства совпадает с именем формы, к которой обращается свойство.

Доступ к формам, предоставляемым объектом, можно получить `My.Forms` с помощью имени формы без уточнения. Так как имя свойства совпадает с именем типа формы, это позволяет получить доступ к форме, как если бы она имела экземпляр по умолчанию. Например, предложение `My.Forms.Form1.Show` эквивалентно предложению `Form1.Show`.

`My.Forms`Объект предоставляет только формы, связанные с текущим проектом. Он не предоставляет доступ к формам, объявленным в упоминаемых библиотеках DLL. Для доступа к форме, предоставляемой библиотекой DLL, необходимо использовать полное имя формы, записанное как *dllname*. *Формнаме*.

Свойство можно использовать <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OpenForms%2A> для получения коллекции всех открытых форм приложения.

Объект и его свойства доступны только для приложений Windows.

## <a name="properties"></a>Свойства

Каждое свойство `My.Forms` объекта предоставляет доступ к экземпляру формы в текущем проекте. Имя свойства совпадает с именем формы, к которой обращается свойство, а тип свойства совпадает с типом формы.

> [!NOTE]
> При конфликте имен имя свойства для доступа к форме — *RootNamespace*_*Namespace* \_ *формнаме*. Например, рассмотрим две формы с именем, `Form1.` Если одна из этих форм находится в корневом пространстве имен `WindowsApplication1` и в пространстве имен `Namespace1` , поэтому доступ к этой форме осуществляется через `My.Forms.WindowsApplication1_Namespace1_Form1` .

`My.Forms`Объект предоставляет доступ к экземпляру главной формы приложения, созданному при запуске. Для всех других форм `My.Forms` объект создает новый экземпляр формы при обращении к нему и сохраняет его. Последующие попытки доступа к этому свойству возвращают этот экземпляр формы.

Форму можно удалить, назначив `Nothing` свойству для этой формы. Средство задания свойств вызывает <xref:System.Windows.Forms.Form.Close%2A> метод формы, а затем присваивает `Nothing` хранимому значению. Если присвоить значение, отличное от `Nothing` свойства, метод задания выдаст <xref:System.ArgumentException> исключение.

Можно проверить `My.Forms` , сохраняет ли свойство объекта экземпляр формы с помощью `Is` `IsNot` оператора или. С помощью этих операторов можно проверить, имеет ли свойство значение `Nothing` .

> [!NOTE]
> Как правило, `Is` `IsNot` оператор или должен считывать значение свойства для выполнения сравнения. Однако если текущее свойство хранится `Nothing` , свойство создает новый экземпляр формы, а затем возвращает этот экземпляр. Однако компилятор Visual Basic обрабатывает свойства объекта по- `My.Forms` разному и позволяет `Is` `IsNot` оператору или проверить состояние свойства без изменения его значения.

## <a name="example"></a>Пример

В этом примере изменяется заголовок формы по умолчанию `SidebarMenu` .

[!code-vb[VbVbalrMyForms#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyForms/VB/Class1.vb#2)]

Чтобы этот пример работал, проект должен иметь форму с именем `SidebarMenu` .

Этот код будет работать только в проекте приложения Windows.

## <a name="requirements"></a>Требования

### <a name="availability-by-project-type"></a>Доступность по типу проекта

|Тип проекта|Доступно|
|---|---|
|Приложение Windows|**Да**|
|Библиотека классов|нет|
|Консольное приложение|нет|
|Библиотека элементов управления Windows|нет|
|Библиотека веб-элементов управления|нет|
|Служба Windows|нет|
|Веб-сайт|нет|

## <a name="see-also"></a>См. также раздел

- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OpenForms%2A>
- <xref:System.Windows.Forms.Form>
- <xref:System.Windows.Forms.Form.Close%2A>
- [Объекты](index.md)
- [Оператор is](../operators/is-operator.md)
- [Оператор IsNot](../operators/isnot-operator.md)
- [Доступ к формам приложения](../../developing-apps/programming/accessing-application-forms.md)
