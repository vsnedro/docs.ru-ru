---
title: Оператор If
ms.date: 07/20/2015
f1_keywords:
- vb.IfOperator
- IfOperator
helpviewer_keywords:
- ternary operators [Visual Basic]
- conditional execution
- If expressions [Visual Basic]
- conditional operator [Visual Basic]
- If Operator [Visual Basic]
ms.assetid: dd56c9df-7cd4-442c-9ba6-20c70ee44c8f
ms.openlocfilehash: 28fb2afb2c4cf78ffbbb028145de647a8dc512ed
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2020
ms.locfileid: "84371107"
---
# <a name="if-operator-visual-basic"></a>Оператор If (Visual Basic)

Использует сокращенную оценку, чтобы условно вернуть одно из двух значений. `If`Оператор может быть вызван с тремя аргументами или с двумя аргументами.

## <a name="syntax"></a>Синтаксис

```vb
If( [argument1,] argument2, argument3 )
```

## <a name="if-operator-called-with-three-arguments"></a>Оператор If с тремя аргументами

Когда `If` вызывается с помощью трех аргументов, первый аргумент должен иметь значение, которое можно привести к типу `Boolean` . Это `Boolean` значение определит, какой из двух других аргументов вычисляется и возвращается. Следующий список применяется только в том случае, если `If` оператор вызывается с помощью трех аргументов.

### <a name="parts"></a>Компоненты

|Термин|Определение|
|---|---|
|`argument1`|Обязательный. `Boolean`. Определяет, какие из других аргументов следует вычислить и вернуть.|
|`argument2`|Обязательный. `Object`. Вычисляется и возвращается, если `argument1` имеет значение `True` .|
|`argument3`|Обязательный. `Object`. Вычисляется и возвращается, если `argument1` принимает значение `False` или, если `argument1` является переменной, [допускающей значение NULL](../../programming-guide/language-features/data-types/nullable-value-types.md) `Boolean` , которая имеет значение [Nothing](../nothing.md).|

`If`Оператор, который вызывается с тремя аргументами, работает как `IIf` функция, за исключением того, что он использует сокращенную оценку. `IIf`Функция всегда вычисляет все три аргумента, в то время как `If` оператор с тремя аргументами вычисляет только два из них. Первый `If` аргумент вычисляется, а результат приводится как `Boolean` значение `True` или `False` . Если значение равно `True` , `argument2` вычисляется и возвращается его значение, но `argument3` не вычисляется. Если значение `Boolean` выражения равно `False` , `argument3` вычисляется и его значение возвращается, но `argument2` не вычисляется. В следующих примерах показано использование, `If` когда используются три аргумента:

[!code-vb[VbVbalrOperators#100](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#100)]

В следующем примере показано значение сокращенного вычисления. В примере показаны две попытки деления переменной `number` на переменную, `divisor` за исключением случаев `divisor` , когда равен нулю. В этом случае возвращается значение 0, и для выполнения деления не нужно предпринимать никаких попыток, поскольку это приведет к ошибке времени выполнения. Поскольку `If` выражение использует сокращенное вычисление, оно вычисляет второй или третий аргумент в зависимости от значения первого аргумента. Если первый аргумент имеет значение true, то делитель не равен нулю и может быть защищен для вычисления второго аргумента и выполнения деления. Если первый аргумент имеет значение false, то вычисляется только третий аргумент и возвращается значение 0. Таким образом, если делитель равен 0, попытки выполнить деление не выполняются и результаты ошибок не выводятся. Однако, поскольку не `IIf` использует сокращенную оценку, второй аргумент вычисляется, даже если первый аргумент имеет значение false. Это приводит к ошибке деления на ноль во время выполнения.

[!code-vb[VbVbalrOperators#101](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#101)]

## <a name="if-operator-called-with-two-arguments"></a>Оператор If с двумя аргументами

Можно опустить первый аргумент `If` . Это позволяет вызывать оператор, используя только два аргумента. Следующий список применяется только в том случае, если `If` оператор вызывается с двумя аргументами.

### <a name="parts"></a>Компоненты

|Термин|Определение|
|---|---|
|`argument2`|Обязательный. `Object`. Должен быть ссылкой или типом значения, допускающим значение null. Вычисляется и возвращается, если он равен чему-либо, кроме `Nothing` .|
|`argument3`|Обязательный. `Object`. Вычисляется и возвращается, если `argument2` имеет значение `Nothing` .|

Если `Boolean` аргумент опущен, первым аргументом должен быть ссылочный тип или значение типа, допускающего значения NULL. Если первый аргумент равен `Nothing` , возвращается значение второго аргумента. Во всех остальных случаях возвращается значение первого аргумента. В следующем примере показано, как работает эта оценка.

[!code-vb[VbVbalrOperators#102](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#102)]

## <a name="see-also"></a>См. также раздел

- <xref:Microsoft.VisualBasic.Interaction.IIf%2A>
- [Типы значений, допускающие значение null](../../programming-guide/language-features/data-types/nullable-value-types.md)
- [Nothing](../nothing.md)
