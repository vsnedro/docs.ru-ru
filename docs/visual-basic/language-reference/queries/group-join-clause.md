---
title: Предложение Group Join
ms.date: 07/20/2015
f1_keywords:
- vb.QueryGroupJoinIn
- vb.QueryGroupJoinOn
- vb.QueryGroupJoin
- vb.QueryGroupJoinInto
helpviewer_keywords:
- Group Join clause [Visual Basic]
- Group Join statement [Visual Basic]
- queries [Visual Basic], Group Join
ms.assetid: 37dbf79c-7b5c-421b-bbb7-dadfd2b92a1c
ms.openlocfilehash: 8d5f3ec80cb39825a3a283907d614b9be28e6e91
ms.sourcegitcommit: d2db216e46323f73b32ae312c9e4135258e5d68e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90869914"
---
# <a name="group-join-clause-visual-basic"></a>Предложение Group Join (Visual Basic)

Объединяет две коллекции в одну иерархическую коллекцию. Операция Join основана на совпадающих ключах.  
  
## <a name="syntax"></a>Синтаксис  
  
```vb  
Group Join element [As type] In collection _  
  On key1 Equals key2 [ And key3 Equals key4 [... ] ] _  
  Into expressionList  
```  
  
## <a name="parts"></a>Компоненты  
  
|Термин|Определение|  
|---|---|  
|`element`|Обязательный. Управляющая переменная для объединяемой коллекции.|  
|`type`|Необязательный элемент. Тип параметра `element`. Если не `type` указано, тип `element` выводится из `collection` .|  
|`collection`|Обязательный элемент. Коллекция для объединения с коллекцией, находящейся в левой части `Group Join` оператора. `Group Join`Предложение может быть вложено в `Join` предложение или в другое `Group Join` предложение.|  
|`key1` `Equals` `key2`|Обязательный элемент. Определяет ключи для соединяемых коллекций. `Equals`Для сравнения ключей из объединяемых коллекций необходимо использовать оператор. Условия объединения можно комбинировать с помощью `And` оператора для обнаружения нескольких ключей. `key1`Параметр должен быть из коллекции в левой части `Join` оператора. `key2`Параметр должен быть из коллекции в правой части `Join` оператора.<br /><br /> Ключи, используемые в условии объединения, могут быть выражениями, включающими более одного элемента из коллекции. Однако каждое ключевое выражение может содержать только элементы из соответствующей коллекции.|  
|`expressionList`|Обязательный элемент. Одно или несколько выражений, которые определяют, как объединяются группы элементов из коллекции. Чтобы указать имя элемента для сгруппированных результатов, используйте `Group` ключевое слово ( `<alias> = Group` ). Вы также можете включать агрегатные функции для применения к группе.|  
  
## <a name="remarks"></a>Remarks  

 `Group Join`Предложение объединяет две коллекции на основе совпадающих значений ключей из объединяемых коллекций. Результирующая коллекция может содержать член, который ссылается на коллекцию элементов из второй коллекции, которая соответствует значению ключа из первой коллекции. Можно также указать агрегатные функции для применения к сгруппированным элементам из второй коллекции. Дополнительные сведения о агрегатных функциях см. в разделе [предложение Aggregate](aggregate-clause.md).  
  
 Рассмотрим, например, коллекцию руководителей и коллекцию сотрудников. Элементы обеих коллекций имеют свойство ManagerID, определяющее сотрудников, которые отправляют отчеты определенному менеджеру. Результаты операции объединения будут содержать результат для каждого менеджера и сотрудника с соответствующим значением ManagerID. Результаты `Group Join` операции будут содержать полный список руководителей. Каждый результат менеджера будет иметь член, который ссылался на список сотрудников, которые были соответствующими руководителю.  
  
 Коллекция, полученная в результате `Group Join` операции, может содержать любое сочетание значений из коллекции, определенной в `From` предложении, и выражения, определенные в `Into` предложении `Group Join` предложения. Дополнительные сведения о допустимых выражениях для `Into` предложения см. в разделе [предложение Aggregate](aggregate-clause.md).  
  
 `Group Join`Операция возвратит все результаты из коллекции, указанной в левой части `Group Join` оператора. Это справедливо, даже если в объединяемой коллекции нет совпадений. Это похоже на `LEFT OUTER JOIN` в SQL.  
  
 Предложение можно использовать `Join` для объединения коллекций в одну коллекцию. Это эквивалентно `INNER JOIN` в SQL.  
  
## <a name="example"></a>Пример  

 В следующем примере кода две коллекции объединяются с помощью `Group Join` предложения.  
  
 [!code-vb[VbSimpleQuerySamples#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbSimpleQuerySamples/VB/QuerySamples1.vb#14)]  
  
## <a name="see-also"></a>См. также

- [Introduction to LINQ in Visual Basic](../../programming-guide/language-features/linq/introduction-to-linq.md) (Знакомство с LINQ в Visual Basic)
- [Запросы](index.md)
- [Предложение SELECT](select-clause.md)
- [Предложение FROM](from-clause.md)
- [Предложение Join](join-clause.md)
- [Предложение WHERE](where-clause.md)
- [Предложение Group By](group-by-clause.md)
