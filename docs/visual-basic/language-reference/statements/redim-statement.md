---
title: Оператор reDim
ms.date: 07/20/2015
f1_keywords:
- vb.ReDim
- vb.Preserve
helpviewer_keywords:
- fixed-length strings [Visual Basic], declaring
- ReDim statement [Visual Basic], syntax
- dynamic arrays [Visual Basic], ReDim statement
- arrays [Visual Basic], reallocating
- arrays [Visual Basic], reinitializing
- arrays [Visual Basic], dimensions
- scalars, and arrays
- scalars
- declarations [Visual Basic], dynamic arrays
- variables [Visual Basic], scalar
- ReDim statement [Visual Basic]
- data types [Visual Basic], assigning
- As keyword [Visual Basic], in ReDim statement
- To keyword [Visual Basic], ReDim statement
- arrays [Visual Basic], declaring
- Preserve keyword [Visual Basic], ReDim statement
- storage [Visual Basic], allocating
- arrays [Visual Basic], and scalars
- declaration statements [Visual Basic]
- scalar variables [Visual Basic]
ms.assetid: ad1c5e07-dcd7-4ae1-a79e-ad3f2dcc2083
ms.openlocfilehash: 17bc806f2e92c61f1dd7425de40b1a68f926a583
ms.sourcegitcommit: d2db216e46323f73b32ae312c9e4135258e5d68e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90872026"
---
# <a name="redim-statement-visual-basic"></a>Оператор ReDim (Visual Basic)

Перераспределяет область хранения для переменной массива.  
  
## <a name="syntax"></a>Синтаксис  
  
```vb  
ReDim [ Preserve ] name(boundlist) [ ,  name(boundlist) [, ... ] ]  
```  
  
## <a name="parts"></a>Компоненты  
  
|Термин|Определение|  
|----------|----------------|  
|`Preserve`|Необязательный элемент. Модификатор, используемый для сохранения данных в существующем массиве при изменении размера только последнего измерения.|  
|`name`|Обязательный элемент. Имя переменной массива. См. раздел [Declared Element Names](../../programming-guide/language-features/declared-elements/declared-element-names.md).|  
|`boundlist`|Обязательный элемент. Список границ для всех измерений переопределенного массива.|  
  
## <a name="remarks"></a>Remarks  

 Для изменения размера одного или нескольких из уже объявленных измерений массива можно использовать оператор `ReDim`. Если у вас есть большой массив и некоторые из входящих в него элементов больше не требуются, `ReDim` позволяет освободить память, уменьшив размер массива. Если же массив требует дополнительных элементов, `ReDim` может их добавить.  
  
 Оператор `ReDim` предназначен только для массивов. Он не подходит для скалярных величин (переменных, содержащих единственное значение), коллекций или структур. Обратите внимание, что при объявлении переменной типа `Array` у оператора `ReDim` не будет достаточной информации о типе для создания нового массива.  
  
 Оператор `ReDim` можно использовать только на уровне процедуры. В связи с этим контекст объявления для переменной должен быть процедурой; он не может быть исходным файлом, пространством имен, интерфейсом, классом, структурой, модулем или блоком. Дополнительные сведения см. в разделе [Контексты объявления и уровни доступа по умолчанию](declaration-contexts-and-default-access-levels.md).  
  
## <a name="rules"></a>Правила  
  
- **Множество переменных.** Можно изменить размер нескольких переменных массива в одном операторе объявления и указать `name` `boundlist` части и для каждой переменной. Переменные разделяются запятыми.  
  
- **Границы массива.** Каждая запись в `boundlist` может указывать нижнюю и верхнюю границы этого измерения. Нижняя граница всегда 0 (ноль). Верхняя граница представляет собой наибольшее возможное значение индекса для этого измерения, но не длину измерения (она равна верхней границе плюс один). Индекс для каждого измерения может варьироваться от 0 до значения верхней границы.  
  
     Число измерений в `boundlist` должно совпадать с исходным числом измерений (рангом) массива.  
  
- **Типы данных.** `ReDim`Инструкция не может изменить тип данных переменной массива или ее элементов.  
  
- **Инициализации.** `ReDim`Инструкция не может предоставлять новые значения инициализации для элементов массива.  
  
- **Рейтинг.** `ReDim`Оператор не может изменить ранг (число измерений) массива.  
  
- **Изменение размера с помощью оператора Preserve.** При использовании `Preserve` можно изменить размер только последнего измерения массива. Для всех остальных измерений необходимо указывать привязку существующего массива.  
  
     Например, в одномерных массивах можно изменить это измерение и в то же время сохранить все содержимое массива, поскольку изменяется только одно, последнее, измерение. Если же массив имеет два или больше измерений, то с помощью оператора Preserve можно изменить только последнее измерение массива.`Preserve`  
  
- **Свойства.** Можно использовать `ReDim` для свойства, содержащего массив значений.  
  
## <a name="behavior"></a>Поведение  
  
- **Замена массива.** `ReDim` Освобождает существующий массив и создает новый массив с тем же рангом. Новый массив заменяет освобожденный массив в переменной массива.  
  
- **Инициализация без использования оператора Preserve.** Если не указать `Preserve` , `ReDim` инициализирует элементы нового массива, используя значение по умолчанию для их типа данных.  
  
- **Инициализация с использованием оператора Preserve.** Если указано `Preserve` , Visual Basic копирует элементы из существующего массива в новый массив.  
  
## <a name="example"></a>Пример  

 В приведенном ниже примере производится увеличение размера последнего измерения динамического массива без потери существующих данных, а затем уменьшение размера массива с частичной потерей данных. Кроме того, размер массива уменьшается до исходного значения и все элементы массива инициализируются повторно.  
  
 [!code-vb[VbVbalrStatements#52](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#52)]  
  
 Оператор `Dim` создает новый массив с тремя измерениями. Каждое измерение объявляется с границей 10, поэтому индекс массива для каждого измерения может варьироваться в диапазоне от 0 до 10. В приведенном ниже описании эти три измерения называются слоем, строкой и столбцом.  
  
 Первый оператор `ReDim` создает новый массив, который заменяет существующий массив в переменной `intArray`. Оператор `ReDim` копирует все элементы из существующего массива в новый массив. Кроме того, он добавляет по десять столбцов в конец каждой строки каждого слоя и инициализирует элементы в этих новых столбцах со значением 0 (значение параметра `Integer`, который является типом элемента массива, по умолчанию).  
  
 Второй оператор `ReDim` создает еще один массив и копирует в него все подходящие элементы. При этом в каждой строке каждого слоя теряются пять последних столбцов. Это не проблема, если данные столбцы вам больше не нужны. Уменьшение размера большого массива позволяет освободить память, которая больше не требуется.  
  
 Третий оператор `ReDim` создает еще один массив и удаляет еще пять столбцов в конце каждой строки каждого слоя. В данном случае он не копирует существующие элементы. Этот оператор возвращает массиву первоначальный размер. Поскольку оператор не включает модификатор `Preserve`, он приводит все элементы массива к исходным значениям по умолчанию.  
  
 Дополнительные примеры см. в разделе [массивы](../../programming-guide/language-features/arrays/index.md).  
  
## <a name="see-also"></a>См. также

- <xref:System.IndexOutOfRangeException>
- [Оператор Const](const-statement.md)
- [Оператор Dim](dim-statement.md)
- [Оператор Erase](erase-statement.md)
- [Nothing](../nothing.md)
- [Массивы](../../programming-guide/language-features/arrays/index.md)
