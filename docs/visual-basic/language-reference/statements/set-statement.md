---
title: Оператор Set
ms.date: 07/20/2015
f1_keywords:
- vb.Set
helpviewer_keywords:
- property procedures [Visual Basic], Set statements
- Set statement [Visual Basic]
- Set statement [Visual Basic], syntax
- write-only properties
- properties [Visual Basic], write-only
ms.assetid: 9ecc27b4-df84-420d-9075-db25455fb3cd
ms.openlocfilehash: b3524769567a56a87184bf916a3e5ccb1fd4fa1c
ms.sourcegitcommit: d2db216e46323f73b32ae312c9e4135258e5d68e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90871757"
---
# <a name="set-statement-visual-basic"></a>Инструкция Set (Visual Basic)

Объявляет `Set` процедуру свойства, используемую для присвоения значения свойству.  
  
## <a name="syntax"></a>Синтаксис  
  
```vb  
[ <attributelist> ] [ accessmodifier ] Set (ByVal value [ As datatype ])  
    [ statements ]  
End Set  
```  
  
## <a name="parts"></a>Компоненты  

 `attributelist`  
 Необязательный элемент. См. [список атрибутов](attribute-list.md).  
  
 `accessmodifier`  
 Необязательно для одного из `Get` `Set` операторов и в этом свойстве. Может применяться один из перечисленных ниже типов.  
  
- [От](../modifiers/protected.md)  
  
- [Friend](../modifiers/friend.md)  
  
- [Частная](../modifiers/private.md)  
  
- `Protected Friend`  
  
 См. раздел [уровни доступа в Visual Basic](../../programming-guide/language-features/declared-elements/access-levels.md).  
  
 `value`  
 Обязательный элемент. Параметр, содержащий новое значение свойства.  
  
 `datatype`  
 Обязательный `Option Strict` , если имеет значение `On` . Тип данных `value` параметра. Указанный тип данных должен совпадать с типом данных свойства, в котором `Set` объявлен этот оператор.  
  
 `statements`  
 Необязательный элемент. Одна или несколько инструкций, выполняемых при `Set` вызове процедуры свойства.  
  
 `End Set`  
 Обязательный элемент. Завершает определение `Set` процедуры свойства.  
  
## <a name="remarks"></a>Remarks  

 Каждое свойство должно иметь `Set` процедуру свойства, если только свойство не помечено как `ReadOnly` . `Set`Процедура используется для задания значения свойства.  
  
 Visual Basic автоматически вызывает процедуру свойства, `Set` когда оператор присваивания предоставляет значение, которое должно храниться в свойстве.  
  
 Visual Basic передает параметр в `Set` процедуру во время назначения свойств. Если параметр для не указан `Set` , в интегрированной среде разработки (IDE) используется неявный параметр с именем `value` . Параметр содержит значение, присваиваемое свойству. Обычно это значение сохраняется в закрытой локальной переменной и возвращается при каждом `Get` вызове процедуры.  
  
 Текст объявления свойства может содержать только `Get` процедуры свойства и `Set` между [оператором Property](property-statement.md) и `End Property` оператором. Он не может хранить ничего, Кроме этих процедур. В частности, он не может хранить текущее значение свойства. Это значение необходимо хранить за пределами свойства, так как при хранении в любой из процедур свойств другая процедура свойства не может получить к ней доступ. Обычным подходом является сохранение значения в [закрытой](../modifiers/private.md) переменной, объявленной на том же уровне, что и свойство. Необходимо определить `Set` процедуру внутри свойства, к которому она применяется.  
  
 `Set`Процедура по умолчанию имеет уровень доступа содержащего его свойства, если только не используется `accessmodifier` в `Set` инструкции.  
  
## <a name="rules"></a>Правила  
  
- **Уровни смешанного доступа.** При определении свойства для чтения и записи можно дополнительно указать другой уровень доступа для `Get` `Set` процедуры или, но не для обоих. В этом случае уровень доступа процедуры должен быть более четким, чем уровень доступа свойства. Например, если свойство объявлено `Friend` , можно объявить `Set` процедуру `Private` , но не `Public` .  
  
     При определении `WriteOnly` свойства `Set` процедура представляет все свойство. Нельзя объявить другой уровень доступа для `Set` , так как для свойства будет задано два уровня доступа.  
  
## <a name="behavior"></a>Поведение  
  
- **Возврат из процедуры свойства.** Когда `Set` процедура возвращается в вызывающий код, выполнение продолжится после оператора, который предоставил значение для сохранения.  
  
     `Set` процедуры свойств могут возвращать использование либо [оператора return](return-statement.md) , либо [оператора Exit](exit-statement.md).  
  
     `Exit Property`Операторы и `Return` вызывают немедленный выход из процедуры свойства. Любое количество `Exit Property` инструкций и `Return` может использоваться в любом месте процедуры, и можно смешивать `Exit Property` `Return` операторы и.  
  
## <a name="example"></a>Пример  

 В следующем примере инструкция используется `Set` для задания значения свойства.  
  
 [!code-vb[VbVbalrStatements#55](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#55)]  
  
## <a name="see-also"></a>См. также

- [Оператор Get](get-statement.md)
- [Property Statement](property-statement.md)
- [Оператор Sub](sub-statement.md)
- [Процедуры свойств](../../programming-guide/language-features/procedures/property-procedures.md)
