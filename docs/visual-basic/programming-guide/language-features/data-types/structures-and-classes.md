---
title: Структуры и классы
ms.date: 07/20/2015
helpviewer_keywords:
- classes [Visual Basic], vs. structures
- structures [Visual Basic]
- classes [Visual Basic]
- structures [Visual Basic], compared to classes
- structures [Visual Basic], structure variables
- structure variables [Visual Basic]
ms.assetid: a221e74a-ffcf-4bdc-a0f6-a088a9bf26cc
ms.openlocfilehash: e7ca5b9d55611eafad88517e71f9807fe2aa4416
ms.sourcegitcommit: bf5c5850654187705bc94cc40ebfb62fe346ab02
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/23/2020
ms.locfileid: "91086222"
---
# <a name="structures-and-classes-visual-basic"></a>Структуры и классы (Visual Basic)

Visual Basic объединяет синтаксис структур и классов, в результате чего обе сущности поддерживают большинство одних и тех же функций. Однако существуют и важные различия между структурами и классами.  
  
 Классы имеют преимущество ссылочных типов — передача ссылки более эффективна, чем передача переменной структуры со всеми ее данными. С другой стороны, структуры не нуждаются в выделении памяти в глобальной куче.  
  
 Поскольку наследование из структуры невозможно, структуры следует использовать только для объектов, которые не нужно расширять. Используйте структуры, если создаваемый объект имеет небольшой размер экземпляра и учитывает характеристики производительности классов и структур.  
  
## <a name="similarities"></a>Сходства  

 Структуры и классы похожи в следующих отношениях:  
  
- Оба типа являются типами *контейнеров* , то есть они содержат другие типы в качестве членов.  
  
- Оба имеют члены, которые могут включать конструкторы, методы, свойства, поля, константы, перечисления, события и обработчики событий. Однако не путайте эти члены с объявленными *элементами* структуры.  
  
- Члены обоих типов могут иметь индивидуальные уровни доступа. Например, можно объявить один член `Public` и другой `Private` .  
  
- Оба могут реализовывать интерфейсы.  
  
- Оба могут иметь общие конструкторы с параметрами или без них.  
  
- Оба свойства могут предоставлять *свойство по умолчанию*, если это свойство принимает по крайней мере один параметр.  
  
- Оба могут объявлять и создавать события, и оба могут объявлять делегаты.  
  
## <a name="differences"></a>Различия  

 Структуры и классы отличаются в следующих особенности:  
  
- Структуры являются *типами значений*; классы являются *ссылочными типами*. Переменная типа структуры содержит данные структуры, а не содержит ссылку на данные в качестве типа класса.  
  
- Структуры используют выделение стека; классы используют выделение кучи.  
  
- Все элементы структуры по `Public` умолчанию. переменные класса и константы по умолчанию используются `Private` , а другие члены класса `Public` по умолчанию. Такое поведение членов класса обеспечивает совместимость с системой по умолчанию Visual Basic 6,0.  
  
- Структура должна иметь по крайней мере одну необщую переменную или ненастраиваемый нестандартный элемент события; класс может быть полностью пустым.  
  
- Элементы структуры не могут объявляться как `Protected` ; члены класса могут.  
  
- Процедура структуры может обрабатывать события только в том случае, если это [Общая](../../../language-reference/modifiers/shared.md) `Sub` процедура, и только с помощью [оператора AddHandler](../../../language-reference/statements/addhandler-statement.md); любая процедура класса может обрабатывать события с помощью ключевого слова [Handles](../../../language-reference/statements/handles-clause.md) или `AddHandler` инструкции. Дополнительные сведения см. в статье [Events (Visual Basic)](../events/index.md) (События в Visual Basic).  
  
- В объявлениях переменных структуры не могут указываться инициализаторы или исходные размеры для массивов; объявления переменных класса могут.  
  
- Структуры неявно наследуют от <xref:System.ValueType?displayProperty=nameWithType> класса и не могут наследовать от любого другого типа; классы могут наследовать от любого класса или классов, отличных от <xref:System.ValueType?displayProperty=nameWithType> .  
  
- Структуры не наследуются; классы.  
  
- Структуры никогда не завершаются, поэтому среда CLR никогда не вызывает <xref:System.Object.Finalize%2A> метод для любой структуры; классы завершаются сборщиком мусора (GC), который вызывает <xref:System.Object.Finalize%2A> класс при обнаружении активных ссылок.  
  
- Для структуры не требуется конструктор; класс выполняет.  
  
- Структуры могут иметь необщие конструкторы, только если они принимают параметры. классы могут иметь параметры с параметрами или без них.  
  
 Каждая структура имеет неявный открытый конструктор без параметров. Этот конструктор инициализирует все элементы данных структуры значениями по умолчанию. Это поведение нельзя переопределить.  
  
## <a name="instances-and-variables"></a>Экземпляры и переменные  

 Поскольку структуры являются типами значений, каждая переменная структуры постоянно привязана к отдельному экземпляру структуры. Классы являются ссылочными типами, и объектная переменная может ссылаться на различные экземпляры класса в разное время. Это различие влияет на использование структур и классов следующими способами.  
  
- **Инициализации.** Переменная структуры неявно включает инициализацию элементов с помощью конструктора без параметров структуры. Таким образом, `Dim s As struct1` эквивалентен `Dim s As struct1 = New struct1()` .  
  
- **Присвоение переменных.** При назначении одной переменной структуры другому или передаче экземпляра структуры в аргумент процедуры текущие значения всех элементов переменной копируются в новую структуру. При присвоении одной переменной объекта другому или передаче переменной объекта в процедуру копируется только указатель ссылки.  
  
- **Ничего не назначается.** Переменной структуры можно присвоить значение [Nothing](../../../language-reference/nothing.md) , но экземпляр будет связан с переменной. Вы по-прежнему можете вызывать свои методы и обращаться к его элементам данных, хотя переменные элементы повторно инициализируются с помощью назначения.  
  
     Напротив, если для переменной объекта задано значение `Nothing` , то связь с любым экземпляром класса отменяется, и вы не сможете получить доступ к членам через переменную, пока не назначите ей другой экземпляр.  
  
- **Несколько экземпляров.** Объектная переменная может иметь разные экземпляры класса, назначенные ему в разное время, а несколько объектных переменных могут одновременно ссылаться на один и тот же экземпляр класса. Изменения, вносимые в значения членов класса, влияют на эти члены при доступе через другую переменную, указывающую на тот же экземпляр.  
  
     Однако элементы структуры изолированы в своем собственном экземпляре. Изменения в их значениях не отражаются ни в каких других переменных структуры, даже в других экземплярах того же `Structure` объявления.  
  
- **Проверке.** Проверка на равенство двух структур должна выполняться с помощью тестового элемента. С помощью метода можно сравнивать две переменные объекта <xref:System.Object.Equals%2A> . <xref:System.Object.Equals%2A> Указывает, указывают ли две переменные на один и тот же экземпляр.  
  
## <a name="see-also"></a>См. также

- [Типы данных](index.md)
- [Составные типы данных](composite-data-types.md)
- [Value Types and Reference Types](value-types-and-reference-types.md)
- [Структуры](structures.md)
- [Устранение неполадок, связанных с типами данных](troubleshooting-data-types.md)
- [Структуры и другие элементы программирования](structures-and-other-programming-elements.md)
- [Объекты и классы](../objects-and-classes/index.md)
