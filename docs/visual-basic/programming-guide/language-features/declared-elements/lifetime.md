---
title: Время существования
ms.date: 07/20/2015
helpviewer_keywords:
- static variables [Visual Basic], lifetime
- static variables [Visual Basic], Visual Basic
- declared elements [Visual Basic], lifetime
- Shared variable lifetime [Visual Basic]
- lifetime [Visual Basic], declared elements
- lifetime [Visual Basic], Visual Basic
- lifetime [Visual Basic]
ms.assetid: bd91e390-690a-469a-9946-8dca70bc14e7
ms.openlocfilehash: 377f0e0b5240c3da931dc4af5439aba8924f1e81
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2020
ms.locfileid: "84357145"
---
# <a name="lifetime-in-visual-basic"></a>Время существования в Visual Basic
Время *существования* объявленного элемента — это период времени, в течение которого он доступен для использования. Переменные — это единственные элементы, имеющие время существования. Для этой цели компилятор обрабатывает параметры и функции процедуры как особые случаи использования переменных. Время существования переменной представляет собой период времени, в течение которого она может содержать значение. Его значение может меняться в течение времени существования, но оно всегда содержит какое бы то ни было значение.  
  
## <a name="different-lifetimes"></a>Разные времена жизни  
 *Переменная-член* (объявленная на уровне модуля, вне любой процедуры) обычно имеет то же время существования, что и элемент, в котором она объявлена. Необщая переменная, объявленная в классе или структуре, существует как отдельная копия для каждого экземпляра класса или структуры, в которой он объявлен. Каждая такая переменная имеет то же время существования, что и ее экземпляр. Однако `Shared` переменная имеет только одно время существования, что продолжается в течение всего времени выполнения приложения.  
  
 *Локальная переменная* (объявленная внутри процедуры) существует только во время выполнения процедуры, в которой она объявлена. Это относится также к параметрам этой процедуры и к любой функции, возвращаемой функцией. Однако если эта процедура вызывает другие процедуры, локальные переменные сохраняют свои значения во время выполнения вызванных процедур.  
  
## <a name="beginning-of-lifetime"></a>Начало срока действия  
 Время существования локальной переменной начинается, когда Управление входит в процедуру, в которой она объявлена. Каждая локальная переменная инициализируется значением по умолчанию для ее типа данных, как только начинается выполнение процедуры. Когда процедура встречает `Dim` инструкцию, которая указывает начальные значения, она устанавливает эти переменные в эти значения, даже если код уже назначил им другие значения.  
  
 Каждый член переменной структуры инициализируется так, как если бы он был отдельной переменной. Аналогичным образом каждый элемент переменной массива инициализируется по отдельности.  
  
 Переменные, объявленные внутри блока внутри процедуры (например, `For` цикла), инициализируются при входе в процедуру. Эти инициализации вступают в силу независимо от того, исполняется ли код в блоке.  
  
## <a name="end-of-lifetime"></a>Окончание времени существования  
 После завершения процедуры значения ее локальных переменных не сохраняются, и Visual Basic освобождает память. При следующем вызове процедуры все ее локальные переменные создаются заново и повторно инициализируются.  
  
 При завершении экземпляра класса или структуры его несовместное использование переменных приводит к потере памяти и их значений. Каждый новый экземпляр класса или структуры создает и повторно инициализирует свои переменные, не являющиеся общими. Однако `Shared` переменные сохраняются до тех пор, пока приложение не прекратит работу.  
  
## <a name="extension-of-lifetime"></a>Продление срока жизни  
 Если объявить локальную переменную с `Static` ключевым словом, ее время существования превышает время выполнения процедуры. В следующей таблице показано, как объявление процедуры определяет срок `Static` существования переменной.  
  
|Расположение процедуры и совместное использование|Начало жизни статической переменной|Конец времени существования статической переменной|  
|------------------------------------|-------------------------------------|-----------------------------------|  
|В модуле (совместно используется по умолчанию)|При первом вызове процедуры|При остановке работы приложения|  
|В классе `Shared` (процедура не является членом экземпляра)|При первом вызове процедуры либо в определенном экземпляре, либо в самом классе или имени структуры.|При остановке работы приложения|  
|В экземпляре класса Not `Shared` (процедура является членом экземпляра)|При первом вызове процедуры в конкретном экземпляре|Когда экземпляр выпускается для сборки мусора (GC)|  
  
## <a name="static-variables-of-the-same-name"></a>Статические переменные с одинаковым именем  
 Статические переменные с одинаковым именем можно объявить в нескольких процедурах. В этом случае компилятор Visual Basic считает каждую такую переменную отдельным элементом. Инициализация одной из этих переменных не влияет на значения других. То же самое применимо при определении процедуры с набором перегрузок и объявлении статической переменной с тем же именем в каждой перегрузке.  
  
## <a name="containing-elements-for-static-variables"></a>Содержащие элементы для статических переменных  
 Статическую локальную переменную можно объявить внутри класса, то есть внутри процедуры в этом классе. Однако нельзя объявить статическую локальную переменную в структуре как член структуры или как локальную переменную процедуры в этой структуре.  
  
## <a name="example"></a>Пример  
  
### <a name="description"></a>Описание  
 В следующем примере объявляется переменная с ключевым словом [static](../../../language-reference/modifiers/static.md) . (Обратите внимание, что `Dim` ключевое слово не требуется, если [оператор Dim](../../../language-reference/statements/dim-statement.md) использует модификатор, такой как `Static` .)  
  
### <a name="code"></a>Код  
 [!code-vb[VbVbalrKeywords#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrKeywords/VB/class7.vb#13)]  
  
### <a name="comments"></a>Комментарии  
 В предыдущем примере переменная `applesSold` продолжит существовать после `runningTotal` возврата процедуры в вызывающий код. При следующем `runningTotal` вызове метода `applesSold` сохраняется ранее вычисленное значение.  
  
 Если было `applesSold` объявлено без использования `Static` , то предыдущие накопленные значения не будут сохранены при вызовах `runningTotal` . В следующий раз было `runningTotal` вызвано, что было `applesSold` бы повторно создано и инициализировано в 0 и было `runningTotal` бы просто возвращало то же значение, с которым он был вызван.  
  
### <a name="compile-the-code"></a>Компиляция кода  
 Значение статической локальной переменной можно инициализировать как часть ее объявления. Если массив объявляется как `Static` , можно инициализировать его ранг (число измерений), длину каждого измерения и значения отдельных элементов.  
  
### <a name="security"></a>Безопасность  
 В предыдущем примере можно создать то же время существования, объявляя `applesSold` на уровне модуля. Однако если изменить область переменной таким образом, процедура больше не будет иметь монопольный доступ к ней. Поскольку другие процедуры могут получить доступ к `applesSold` своему значению и изменить его значение, промежуточное Итого может быть ненадежным, а код может быть труднее поддерживать.  
  
## <a name="see-also"></a>См. также раздел

- [Общий](../../../language-reference/modifiers/shared.md)
- [Nothing](../../../language-reference/nothing.md)
- [Declared Element Names](declared-element-names.md)
- [References to Declared Elements](references-to-declared-elements.md)
- [Область видимости в Visual Basic](scope.md)
- [Уровни доступа в Visual Basic](access-levels.md)
- [Переменные](../variables/index.md)
- [Объявление переменной](../variables/variable-declaration.md)
- [Устранение неполадок, связанных с типами данных](../data-types/troubleshooting-data-types.md)
- [Статическое](../../../language-reference/modifiers/static.md)
