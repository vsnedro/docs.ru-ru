---
title: Передача аргументов по значению и по ссылке
ms.date: 07/20/2015
helpviewer_keywords:
- ByRef keyword [Visual Basic], passing arguments by reference
- Visual Basic code, procedures
- passing arguments [Visual Basic], by value or by reference
- ByVal keyword [Visual Basic], passing arguments by value
- arguments [Visual Basic], passing by value or by reference
- argument passing [Visual Basic], by value or by reference
ms.assetid: fd8a9de6-7178-44d5-a9bf-458d4ad907c2
ms.openlocfilehash: 3dd4be6ea6de9dfe8eb165e5d4ba9a990fc40585
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2020
ms.locfileid: "84363958"
---
# <a name="passing-arguments-by-value-and-by-reference-visual-basic"></a>Передача аргументов по значению и по ссылке (Visual Basic)
В Visual Basic можно передать аргумент в процедуру *по значению* или *по ссылке*. Это называется *механизмом передачи*и определяет, может ли процедура изменять программный элемент, лежащий в основе аргумента в вызывающем коде. Объявление процедуры определяет механизм передачи для каждого параметра, указывая ключевое слово [ByVal](../../../language-reference/modifiers/byval.md) или [ByRef](../../../language-reference/modifiers/byref.md) .  
  
## <a name="distinctions"></a>Различия  
 При передаче аргумента в процедуру следует учитывать несколько различных различий, взаимодействующих друг с другом:  
  
- Является ли базовый программный элемент изменяемым или неизменяемым  
  
- Является ли сам аргумент изменяемым или неизменяемым  
  
- Передается ли аргумент по значению или по ссылке  
  
- Является ли тип данных аргумента типом значения или ссылочным типом  
  
 Дополнительные сведения см. в разделе [различия между изменяемыми и неизменяемыми аргументами](./differences-between-modifiable-and-nonmodifiable-arguments.md) и [различия между передачей аргумента по значению и по ссылке](./differences-between-passing-an-argument-by-value-and-by-reference.md).  
  
## <a name="choice-of-passing-mechanism"></a>Возможность выбора механизма передачи  
 Необходимо тщательно выбрать механизм передачи для каждого аргумента.  
  
- **Защита**. При выборе между двумя механизмами передачи самый важный критерий — это раскрытие вызывающих переменных для изменения. Преимущество передачи аргумента заключается в том `ByRef` , что процедура может вернуть значение в вызывающий код через этот аргумент. Преимущество передачи аргумента заключается в том `ByVal` , что он защищает переменную от изменения процедурой.  
  
- **Производительность**. Хотя механизм передачи может влиять на производительность кода, разница обычно незначительна. Единственным исключением является переданный тип значения `ByVal` . В этом случае Visual Basic копирует все содержимое данных аргумента. Таким образом, для больших типов значений, таких как структура, может быть более эффективным передать его `ByRef` .  
  
     Для ссылочных типов копируются только указатель на данные (четыре байта на 32-разрядных платформах, восемь байт на 64-разрядных платформах). Таким образом, можно передавать аргументы типа `String` или `Object` по значению без ущерба для производительности.  
  
## <a name="determination-of-the-passing-mechanism"></a>Определение механизма передачи  
 В объявлении процедуры указывается механизм передачи для каждого параметра. Вызывающий код не может переопределить `ByVal` механизм.  
  
 Если параметр объявлен с помощью `ByRef` , вызывающий код может принудительно вызвать механизм `ByVal` , заключив имя аргумента в круглые скобки в вызове. Дополнительные сведения см. [в разделе инструкции. Принудительная передача аргумента по значению](./how-to-force-an-argument-to-be-passed-by-value.md).  
  
 По умолчанию в Visual Basic передаются аргументы по значению.  
  
## <a name="when-to-pass-an-argument-by-value"></a>Когда следует передавать аргумент по значению  
  
- Если вызывающий элемент кода, лежащий в основе аргумента, является неизменяемым элементом, объявите соответствующий параметр [ByVal](../../../language-reference/modifiers/byval.md). Код не может изменять значение неизменяемого элемента.  
  
- Если базовый элемент является изменяемым, но не нужно, чтобы процедура могла изменять ее значение, объявите параметр `ByVal` . Только вызывающий код может изменять значение изменяемого элемента, передаваемого по значению.  
  
## <a name="when-to-pass-an-argument-by-reference"></a>Когда следует передавать аргумент по ссылке  
  
- Если процедуре требуется подлинное изменение базового элемента в вызывающем коде, объявите соответствующий параметр [ByRef](../../../language-reference/modifiers/byref.md).  
  
- Если правильное выполнение кода зависит от процедуры изменения базового элемента в вызывающем коде, объявите параметр `ByRef` . Если передать его по значению или если вызывающий код переопределяет `ByRef` механизм передачи, заключив аргумент в круглые скобки, вызов процедуры может привести к непредвиденным результатам.  
  
## <a name="example"></a>Пример  
  
### <a name="description"></a>Описание  
 В следующем примере показано, когда передавать аргументы по значению и когда передавать их по ссылке. Процедура `Calculate` имеет `ByVal` и параметр, и `ByRef` . Учитывая процентную ставку, `rate` и сумму денег, `debt` задача процедуры заключается в вычислении нового значения для `debt` , которое является результатом применения процентной ставки к исходному значению `debt` . Поскольку `debt` является `ByRef` параметром, новый итог отражается в значении аргумента в вызывающем коде, соответствующем `debt` . Параметр `rate` является `ByVal` параметром, так как `Calculate` не должен изменять его значение.  
  
### <a name="code"></a>Код  
 [!code-vb[VbVbcnProcedures#74](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class2.vb#74)]  
  
## <a name="see-also"></a>См. также раздел

- [Процедуры](./index.md)
- [Параметры и аргументы процедуры](./procedure-parameters-and-arguments.md)
- [Практическое руководство. Передача аргументов в процедуру](./how-to-pass-arguments-to-a-procedure.md)
- [Практическое руководство. Изменение значения аргумента процедуры](./how-to-change-the-value-of-a-procedure-argument.md)
- [Практическое руководство. Защита аргумента процедуры от изменений значения](./how-to-protect-a-procedure-argument-against-value-changes.md)
- [Практическое руководство. Принудительная передача аргумента по значению](./how-to-force-an-argument-to-be-passed-by-value.md)
- [Передача аргументов по позиции и по имени](./passing-arguments-by-position-and-by-name.md)
- [Value Types and Reference Types](../data-types/value-types-and-reference-types.md)
