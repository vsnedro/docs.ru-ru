---
title: Влияние языка и региональных параметров на строки
ms.date: 07/20/2015
helpviewer_keywords:
- locale [Visual Basic], effect on strings
- strings [Visual Basic], locale dependence
ms.assetid: c4664444-ee0d-47bf-bef1-eaa3c54bdd7f
ms.openlocfilehash: 878e028f7c7f0e93752765272e93baa3ffe1426d
ms.sourcegitcommit: bf5c5850654187705bc94cc40ebfb62fe346ab02
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/23/2020
ms.locfileid: "91059222"
---
# <a name="how-culture-affects-strings-in-visual-basic"></a>Влияние языка и региональных параметров на строки в Visual Basic

На этой странице справки обсуждается, как Visual Basic использует сведения о языке и региональных параметрах для преобразования строк и сравнения.  
  
## <a name="when-to-use-culture-specific-strings"></a>Когда следует использовать строки, относящиеся к языку и региональным параметрам  

 Как правило, следует использовать строки, зависящие от языка и региональных параметров, для всех данных, представленных и считываемых пользователями, и использовать строки инвариантных языка и региональных параметров для внутренних данных приложения.  
  
 Например, если приложение запрашивает у пользователей ввод даты в виде строки, оно должно предполагать, что пользователи будут форматировать строки в соответствии с их культурой, и приложение должно соответствующим образом преобразовать строку. Если приложение затем представляет эту дату в пользовательском интерфейсе, оно должно быть представлено в культуре пользователя.  
  
 Однако если приложение передает дату на центральный сервер, то она должна отформатировать строку в соответствии с одной конкретной культурой, чтобы предотвратить путаницу между потенциально разными форматами даты.  
  
## <a name="culture-sensitive-functions"></a>Функции с учетом языка и региональных параметров  

 Все функции преобразования строк Visual Basic (за исключением `Str` `Val` функций и) используют сведения о языке и региональных параметрах приложения, чтобы гарантировать, что преобразования и сравнения подходят для языка и региональных параметров пользователя приложения.  
  
 Ключом к успешному использованию функций преобразования строк в приложениях, работающих на компьютерах с различными параметрами языка и региональных параметров, является понимание того, какие функции используют конкретный параметр языка и региональных параметров, и используется текущий параметр языка и региональных параметров. Обратите внимание, что параметры языка и региональных параметров приложения по умолчанию унаследованы от региональных параметров операционной системы. Дополнительные сведения см. в разделе <xref:Microsoft.VisualBasic.Strings.Asc%2A> ,, <xref:Microsoft.VisualBasic.Strings.AscW%2A> ,,,, <xref:Microsoft.VisualBasic.Strings.Chr%2A> <xref:Microsoft.VisualBasic.Strings.ChrW%2A> <xref:Microsoft.VisualBasic.Strings.Format%2A> <xref:Microsoft.VisualBasic.Conversion.Hex%2A> <xref:Microsoft.VisualBasic.Conversion.Oct%2A> и [функциях преобразования типов](../../../language-reference/functions/type-conversion-functions.md).  
  
 `Str`Функция (преобразует числа в строки) и `Val` (преобразует строки в числа) не использует сведения о языке и региональных параметрах приложения при преобразовании между строками и числами. Вместо этого они распознают только точку (.) в качестве допустимого десятичного разделителя. Аналогами этих функций, учитывающими культурные особенности, являются:  
  
- **Преобразования, использующие текущий язык и региональные параметры.** `CStr`Функции и `Format` преобразуют число в строку, а `CDbl` `CInt` функции и преобразуют строку в число.  
  
- **Преобразования, использующие конкретный язык и региональные параметры.** Каждый объект Number имеет `ToString(IFormatProvider)` метод, который преобразует число в строку и `Parse(String, IFormatProvider)` метод, который преобразует строку в число. Например, `Double` тип предоставляет <xref:System.Double.ToString%28System.IFormatProvider%29> <xref:System.Double.Parse%28System.String%2CSystem.IFormatProvider%29> методы и.  
  
 Дополнительные сведения см. в разделах <xref:Microsoft.VisualBasic.Conversion.Str%2A> и <xref:Microsoft.VisualBasic.Conversion.Val%2A>.  
  
## <a name="using-a-specific-culture"></a>Использование определенного языка и региональных параметров  

 Представьте, что вы разрабатываете приложение, которое отправляет в веб-службу дату (в формате строки). В этом случае приложение должно использовать определенную культуру для преобразования строк. Чтобы проиллюстрировать причину, рассмотрим результат использования <xref:System.DateTime.ToString> метода даты: Если приложение использует этот метод для форматирования даты 4 июля 2005, то при запуске с использованием языка и региональных параметров США English (EN-US) он возвращает "7/4/2005 12:00:00 AM", но при запуске с использованием немецкого языка (de-de) он возвращает "04.07.2005 00:00:00".  
  
 Если необходимо выполнить преобразование строк в определенном формате языка и региональных параметров, следует использовать `CultureInfo` класс, встроенный в .NET Framework. Можно создать новый `CultureInfo` объект для определенного языка и региональных параметров, передав имя языка и региональных параметров в <xref:System.Globalization.CultureInfo.%23ctor%2A> конструктор. Поддерживаемые имена языка и региональных параметров перечислены на <xref:System.Globalization.CultureInfo> странице справки по классам.  
  
 Кроме того, можно получить экземпляр *инвариантного языка и региональных параметров* из <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> Свойства. Инвариантный язык и региональные параметры основаны на английской культуре, но есть некоторые различия. Например, инвариантный язык и региональные параметры задают 24-часовой формат времени вместо 12-часового.  
  
 Чтобы преобразовать дату в строку языка и региональных параметров, передайте <xref:System.Globalization.CultureInfo> объект в метод объекта Date <xref:System.DateTime.ToString%28System.IFormatProvider%29> . Например, следующий код отображает "07/04/2005 00:00:00", независимо от настроек языка и региональных параметров приложения.  
  
 [!code-vb[VbVbalrConcepts#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrConcepts/VB/Class1.vb#1)]  
  
> [!NOTE]
> Литералы даты всегда обрабатываются в соответствии с языком и региональными параметрами английского языка.  
  
## <a name="comparing-strings"></a>Сравнение строк  

 Существуют две важные ситуации, в которых требуется сравнение строк:  
  
- **Сортировка данных для просмотра пользователю.** Используйте операции на основе текущего языка и региональных параметров, чтобы строки были отсортированы соответствующим образом.  
  
- **Определение точного совпадения двух внутренних строк приложения (обычно в целях безопасности).** Используйте операции, которые не учитывают текущий язык и региональные параметры.  
  
 Оба типа сравнений можно выполнять с помощью <xref:Microsoft.VisualBasic.Strings.StrComp%2A> функции Visual Basic. Укажите необязательный `Compare` аргумент для управления типом сравнения: `Text` для большинства входных и выходных данных `Binary` для определения точных совпадений.  
  
 `StrComp`Функция возвращает целое число, указывающее связь между двумя сравниваемыми строками на основе порядка сортировки. Положительное значение для результата указывает, что первая строка больше, чем вторая строка. Отрицательный результат указывает, что первая строка меньше, а нулевое значение указывает на равенство между строками.  
  
 [!code-vb[VbVbalrStrings#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class1.vb#22)]  
  
 Можно также использовать .NET Frameworkный участник `StrComp` функции, <xref:System.String.Compare%2A?displayProperty=nameWithType> метод. Это статический перегруженный метод базового класса String. В следующем примере показано, как используется этот метод:  
  
 [!code-vb[VbVbalrStrings#48](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class2.vb#48)]  
  
 Для более точного контроля над выполнением сравнений можно использовать дополнительные перегрузки <xref:System.String.Compare%2A> метода. С помощью <xref:System.String.Compare%2A?displayProperty=nameWithType> метода можно `comparisonType` указать, какой тип сравнения следует использовать, с помощью аргумента.  
  
|Значение `comparisonType` аргумента|Тип сравнения|Назначение|  
|---|---|---|  
|`Ordinal`|Сравнение на основе байтов компонента строк.|Используйте это значение при сравнении: идентификаторы с учетом регистра, параметры, связанные с безопасностью, или другие нелингвистические идентификаторы, где байты должны точно совпадать.|  
|`OrdinalIgnoreCase`|Сравнение на основе байтов компонента строк.<br /><br /> `OrdinalIgnoreCase` использует инвариантные сведения о культуре, чтобы определить, когда два символа отличаются только прописными буквами.|Используйте это значение при сравнении: идентификаторы без учета регистра, параметры, связанные с безопасностью, и данные, хранящиеся в Windows.|  
|`CurrentCulture` или `CurrentCultureIgnoreCase`|Сравнение на основе интерпретации строк в текущем языке и региональных параметрах.|Используйте эти значения при сравнении: данные, отображаемые пользователю, большинство вводимых пользователем данных и другие данные, для которых требуется лингвистическая интерпретация.|  
|`InvariantCulture` или `InvariantCultureIgnoreCase`|Сравнение на основе интерпретации строк в инвариантном языке и региональных параметрах.<br /><br /> Это отличается от `Ordinal` и `OrdinalIgnoreCase` , поскольку инвариантный язык и региональные параметры рассматривают символы за пределами принятого диапазона как эквивалентные инвариантные символы.|Используйте эти значения только при сравнении сохраняемых данных или при отображении лингвистических релевантных данных, для которых требуется фиксированный порядок сортировки.|  
  
### <a name="security-considerations"></a>Вопросы безопасности  

 Если приложение принимает решения по обеспечению безопасности на основе результатов операции сравнения или изменения регистра, то операция должна использовать <xref:System.String.Compare%2A?displayProperty=nameWithType> метод и передать `Ordinal` или `OrdinalIgnoreCase` для `comparisonType` аргумента.  
  
## <a name="see-also"></a>См. также

- <xref:System.Globalization.CultureInfo>
- [Знакомство со строками в Visual Basic](introduction-to-strings.md)
- [Type Conversion Functions](../../../language-reference/functions/type-conversion-functions.md)
